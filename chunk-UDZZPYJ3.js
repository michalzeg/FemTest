import{A as di,a as Ct,b as ri,c as ai,d as Ts,e as Ve,f as ho,g as Ye,h as Es,i as Ns,j as ks,k as Ps,l as Os,m as Is,n as go,o as Ls,p as As,q as Ds,r as Fs,s as Rs,t as Jl,u as Ql,v as sn,w as rn,y as Vs,z as Bs}from"./chunk-BWKBDZKX.js";import{$ as qs,Aa as pn,Ba as un,Ca as dn,Da as ye,Ea as _e,Fa as be,Ga as we,Ha as Ce,Ia as Se,Ka as Me,La as fn,Ma as ve,Na as Xs,O as Gs,Oa as xe,P as an,Pa as hn,Q as nt,Qa as Te,R as ot,Ra as Js,S as oe,Sa as Ee,Ta as Qs,Ua as Ne,Va as Zs,Wa as ke,Xa as Pe,Ya as gn,Z as js,Za as Oe,_ as $s,aa as Ws,ba as Ks,ca as se,d as Ss,da as re,e as Ms,ea as ln,fa as ae,g as vs,ga as fi,ha as le,ia as Us,ja as ce,ka as St,la as me,m as xs,ma as cn,na as pe,qa as ue,ra as hi,sa as de,ta as Ys,ua as fe,va as Hs,wa as zs,xa as he,ya as ge,za as mn}from"./chunk-DWKH7MRO.js";import{Ab as M,B as ms,Bb as v,D as tn,Ia as fs,Ja as b,Jb as fo,Kb as ys,Mb as S,Nb as X,Ob as nn,P as ps,Q as $e,Qb as P,R as z,Ra as uo,Rb as O,Sb as I,T as us,Tb as _s,Ub as on,Vb as bs,Wa as ne,Ya as hs,_ as Y,_a as wt,a as oi,ab as Ue,b as ss,bc as ws,cc as Cs,dc as ui,e as A,ea as w,f as po,fa as C,g as W,h as g,hb as T,hc as qe,ia as bt,kb as gs,m as rs,mb as si,nb as Ae,ob as De,pa as ds,pb as Fe,q as as,qb as p,r as ls,rb as m,sb as F,v as ki,wb as ee,x as cs}from"./chunk-Y2PCDT3U.js";var ir=A((od,tr)=>{"use strict";var Zl=typeof global=="object"&&global&&global.Object===Object&&global;tr.exports=Zl});var Pi=A((sd,nr)=>{"use strict";var ec=ir(),tc=typeof self=="object"&&self&&self.Object===Object&&self,ic=ec||tc||Function("return this")();nr.exports=ic});var yo=A((rd,or)=>{"use strict";var nc=Pi(),oc=nc.Symbol;or.exports=oc});var lr=A((ad,ar)=>{"use strict";var sr=yo(),rr=Object.prototype,sc=rr.hasOwnProperty,rc=rr.toString,Oi=sr?sr.toStringTag:void 0;function ac(n){var e=sc.call(n,Oi),t=n[Oi];try{n[Oi]=void 0;var i=!0}catch{}var o=rc.call(n);return i&&(e?n[Oi]=t:delete n[Oi]),o}ar.exports=ac});var mr=A((ld,cr)=>{"use strict";var lc=Object.prototype,cc=lc.toString;function mc(n){return cc.call(n)}cr.exports=mc});var fr=A((cd,dr)=>{"use strict";var pr=yo(),pc=lr(),uc=mr(),dc="[object Null]",fc="[object Undefined]",ur=pr?pr.toStringTag:void 0;function hc(n){return n==null?n===void 0?fc:dc:ur&&ur in Object(n)?pc(n):uc(n)}dr.exports=hc});var _o=A((md,hr)=>{"use strict";function gc(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}hr.exports=gc});var yr=A((pd,gr)=>{"use strict";var yc=fr(),_c=_o(),bc="[object AsyncFunction]",wc="[object Function]",Cc="[object GeneratorFunction]",Sc="[object Proxy]";function Mc(n){if(!_c(n))return!1;var e=yc(n);return e==wc||e==Cc||e==bc||e==Sc}gr.exports=Mc});var br=A((ud,_r)=>{"use strict";var vc=Pi(),xc=vc["__core-js_shared__"];_r.exports=xc});var Sr=A((dd,Cr)=>{"use strict";var bo=br(),wr=function(){var n=/[^.]+$/.exec(bo&&bo.keys&&bo.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Tc(n){return!!wr&&wr in n}Cr.exports=Tc});var vr=A((fd,Mr)=>{"use strict";var Ec=Function.prototype,Nc=Ec.toString;function kc(n){if(n!=null){try{return Nc.call(n)}catch{}try{return n+""}catch{}}return""}Mr.exports=kc});var Tr=A((hd,xr)=>{"use strict";var Pc=yr(),Oc=Sr(),Ic=_o(),Lc=vr(),Ac=/[\\^$.*+?()[\]{}|]/g,Dc=/^\[object .+?Constructor\]$/,Fc=Function.prototype,Rc=Object.prototype,Vc=Fc.toString,Bc=Rc.hasOwnProperty,Gc=RegExp("^"+Vc.call(Bc).replace(Ac,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jc(n){if(!Ic(n)||Oc(n))return!1;var e=Pc(n)?Gc:Dc;return e.test(Lc(n))}xr.exports=jc});var Nr=A((gd,Er)=>{"use strict";function $c(n,e){return n?.[e]}Er.exports=$c});var _n=A((yd,kr)=>{"use strict";var qc=Tr(),Wc=Nr();function Kc(n,e){var t=Wc(n,e);return qc(t)?t:void 0}kr.exports=Kc});var Ii=A((_d,Pr)=>{"use strict";var Uc=_n(),Yc=Uc(Object,"create");Pr.exports=Yc});var Lr=A((bd,Ir)=>{"use strict";var Or=Ii();function Hc(){this.__data__=Or?Or(null):{},this.size=0}Ir.exports=Hc});var Dr=A((wd,Ar)=>{"use strict";function zc(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}Ar.exports=zc});var Rr=A((Cd,Fr)=>{"use strict";var Xc=Ii(),Jc="__lodash_hash_undefined__",Qc=Object.prototype,Zc=Qc.hasOwnProperty;function em(n){var e=this.__data__;if(Xc){var t=e[n];return t===Jc?void 0:t}return Zc.call(e,n)?e[n]:void 0}Fr.exports=em});var Br=A((Sd,Vr)=>{"use strict";var tm=Ii(),im=Object.prototype,nm=im.hasOwnProperty;function om(n){var e=this.__data__;return tm?e[n]!==void 0:nm.call(e,n)}Vr.exports=om});var jr=A((Md,Gr)=>{"use strict";var sm=Ii(),rm="__lodash_hash_undefined__";function am(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=sm&&e===void 0?rm:e,this}Gr.exports=am});var qr=A((vd,$r)=>{"use strict";var lm=Lr(),cm=Dr(),mm=Rr(),pm=Br(),um=jr();function gi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}gi.prototype.clear=lm;gi.prototype.delete=cm;gi.prototype.get=mm;gi.prototype.has=pm;gi.prototype.set=um;$r.exports=gi});var Kr=A((xd,Wr)=>{"use strict";function dm(){this.__data__=[],this.size=0}Wr.exports=dm});var Yr=A((Td,Ur)=>{"use strict";function fm(n,e){return n===e||n!==n&&e!==e}Ur.exports=fm});var Li=A((Ed,Hr)=>{"use strict";var hm=Yr();function gm(n,e){for(var t=n.length;t--;)if(hm(n[t][0],e))return t;return-1}Hr.exports=gm});var Xr=A((Nd,zr)=>{"use strict";var ym=Li(),_m=Array.prototype,bm=_m.splice;function wm(n){var e=this.__data__,t=ym(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():bm.call(e,t,1),--this.size,!0}zr.exports=wm});var Qr=A((kd,Jr)=>{"use strict";var Cm=Li();function Sm(n){var e=this.__data__,t=Cm(e,n);return t<0?void 0:e[t][1]}Jr.exports=Sm});var ea=A((Pd,Zr)=>{"use strict";var Mm=Li();function vm(n){return Mm(this.__data__,n)>-1}Zr.exports=vm});var ia=A((Od,ta)=>{"use strict";var xm=Li();function Tm(n,e){var t=this.__data__,i=xm(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}ta.exports=Tm});var oa=A((Id,na)=>{"use strict";var Em=Kr(),Nm=Xr(),km=Qr(),Pm=ea(),Om=ia();function yi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}yi.prototype.clear=Em;yi.prototype.delete=Nm;yi.prototype.get=km;yi.prototype.has=Pm;yi.prototype.set=Om;na.exports=yi});var ra=A((Ld,sa)=>{"use strict";var Im=_n(),Lm=Pi(),Am=Im(Lm,"Map");sa.exports=Am});var ca=A((Ad,la)=>{"use strict";var aa=qr(),Dm=oa(),Fm=ra();function Rm(){this.size=0,this.__data__={hash:new aa,map:new(Fm||Dm),string:new aa}}la.exports=Rm});var pa=A((Dd,ma)=>{"use strict";function Vm(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}ma.exports=Vm});var Ai=A((Fd,ua)=>{"use strict";var Bm=pa();function Gm(n,e){var t=n.__data__;return Bm(e)?t[typeof e=="string"?"string":"hash"]:t.map}ua.exports=Gm});var fa=A((Rd,da)=>{"use strict";var jm=Ai();function $m(n){var e=jm(this,n).delete(n);return this.size-=e?1:0,e}da.exports=$m});var ga=A((Vd,ha)=>{"use strict";var qm=Ai();function Wm(n){return qm(this,n).get(n)}ha.exports=Wm});var _a=A((Bd,ya)=>{"use strict";var Km=Ai();function Um(n){return Km(this,n).has(n)}ya.exports=Um});var wa=A((Gd,ba)=>{"use strict";var Ym=Ai();function Hm(n,e){var t=Ym(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}ba.exports=Hm});var Sa=A((jd,Ca)=>{"use strict";var zm=ca(),Xm=fa(),Jm=ga(),Qm=_a(),Zm=wa();function _i(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}_i.prototype.clear=zm;_i.prototype.delete=Xm;_i.prototype.get=Jm;_i.prototype.has=Qm;_i.prototype.set=Zm;Ca.exports=_i});var va=A(($d,Ma)=>{"use strict";var ep="__lodash_hash_undefined__";function tp(n){return this.__data__.set(n,ep),this}Ma.exports=tp});var Ta=A((qd,xa)=>{"use strict";function ip(n){return this.__data__.has(n)}xa.exports=ip});var Na=A((Wd,Ea)=>{"use strict";var np=Sa(),op=va(),sp=Ta();function bn(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new np;++e<t;)this.add(n[e])}bn.prototype.add=bn.prototype.push=op;bn.prototype.has=sp;Ea.exports=bn});var Pa=A((Kd,ka)=>{"use strict";function rp(n,e,t,i){for(var o=n.length,s=t+(i?1:-1);i?s--:++s<o;)if(e(n[s],s,n))return s;return-1}ka.exports=rp});var Ia=A((Ud,Oa)=>{"use strict";function ap(n){return n!==n}Oa.exports=ap});var Aa=A((Yd,La)=>{"use strict";function lp(n,e,t){for(var i=t-1,o=n.length;++i<o;)if(n[i]===e)return i;return-1}La.exports=lp});var Fa=A((Hd,Da)=>{"use strict";var cp=Pa(),mp=Ia(),pp=Aa();function up(n,e,t){return e===e?pp(n,e,t):cp(n,mp,t)}Da.exports=up});var Va=A((zd,Ra)=>{"use strict";var dp=Fa();function fp(n,e){var t=n==null?0:n.length;return!!t&&dp(n,e,0)>-1}Ra.exports=fp});var Ga=A((Xd,Ba)=>{"use strict";function hp(n,e,t){for(var i=-1,o=n==null?0:n.length;++i<o;)if(t(e,n[i]))return!0;return!1}Ba.exports=hp});var $a=A((Jd,ja)=>{"use strict";function gp(n,e){return n.has(e)}ja.exports=gp});var Wa=A((Qd,qa)=>{"use strict";var yp=_n(),_p=Pi(),bp=yp(_p,"Set");qa.exports=bp});var Ua=A((Zd,Ka)=>{"use strict";function wp(){}Ka.exports=wp});var wo=A((ef,Ya)=>{"use strict";function Cp(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=i}),t}Ya.exports=Cp});var za=A((tf,Ha)=>{"use strict";var Co=Wa(),Sp=Ua(),Mp=wo(),vp=1/0,xp=Co&&1/Mp(new Co([,-0]))[1]==vp?function(n){return new Co(n)}:Sp;Ha.exports=xp});var Ja=A((nf,Xa)=>{"use strict";var Tp=Na(),Ep=Va(),Np=Ga(),kp=$a(),Pp=za(),Op=wo(),Ip=200;function Lp(n,e,t){var i=-1,o=Ep,s=n.length,r=!0,a=[],l=a;if(t)r=!1,o=Np;else if(s>=Ip){var c=e?null:Pp(n);if(c)return Op(c);r=!1,o=kp,l=new Tp}else l=e?[]:a;e:for(;++i<s;){var f=n[i],d=e?e(f):f;if(f=t||f!==0?f:0,r&&d===d){for(var u=l.length;u--;)if(l[u]===d)continue e;e&&l.push(d),a.push(f)}else o(l,d,t)||(l!==a&&l.push(d),a.push(f))}return a}Xa.exports=Lp});var Za=A((of,Qa)=>{"use strict";var Ap=Ja();function Dp(n){return n&&n.length?Ap(n):[]}Qa.exports=Dp});var yn={name:"default-section",thickness:1};var er={name:"default-material",modulusOfElasticity:21e10,poissonsRatio:.3,weight:78.5};var el=po(Za());var st=class n{destroyed$=new rs;ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=hs({type:n})};var ut=class n{static stringify(e,t=""){return n._stringifyInternal(e,t,!0)}static stringifyRaw(e,t=""){return n._stringifyInternal(e,t,!1)}static parse(e){return n._parseInternal(e,!0)}static parseRaw(e){return n._parseInternal(e,!1)}static _stringifyInternal(e,t,i){let o=[];for(let s of Object.keys(e)){let r=e[s],a=t?`${t}[${s}]`:s;if(Array.isArray(r))r.forEach((l,c)=>{let f=`${a}[${c}]`;if(l!==null&&typeof l=="object")o.push(n._stringifyInternal(l,f,i));else{let d=i?encodeURIComponent(f):f,u=i?encodeURIComponent(String(l)):String(l);o.push(`${d}=${u}`)}});else if(r!==null&&typeof r=="object")o.push(n._stringifyInternal(r,a,i));else{let l=i?encodeURIComponent(a):a,c=i?encodeURIComponent(String(r)):String(r);o.push(`${l}=${c}`)}}return o.join(`&
`)}static _parseInternal(e,t){let i={};if(!e)return i;let s=e.replace(/(\r\n|\n|\r)/gm,"").split("&").map(r=>r.trim()).filter(r=>r);for(let r of s){let[a,l]=r.split("=");if(!a)continue;let c=t?decodeURIComponent(a):a,f=t?decodeURIComponent(l||""):l||"";n.assignNested(i,c,f)}return i}static assignNested(e,t,i){let o=t.split(/\[|\]/).filter(r=>r!==""),s=e;for(let r=0;r<o.length;r++){let a=o[r],l=r===o.length-1,c=isNaN(Number(a))?a:Number(a);l?s[c]=n.parseValue(i):(c in s||(s[c]=typeof o[r+1]=="number"||!isNaN(Number(o[r+1]))?[]:{}),s=s[c])}}static parseValue(e){return e==="true"?!0:e==="false"?!1:!isNaN(Number(e))&&e.trim()!==""?Number(e):e}};var wn=class n{value=0;disabled=!1;onChange=e=>{};onTouched=()=>{};writeValue(e){this.value=e??""}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}onInput(e){let t=e.target;if(!t)return;let i=Number.parseFloat(t.value);isNaN(i)||(this.value=i,this.onChange(this.value))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ne({type:n,selectors:[["app-input-number"]],features:[_s([{provide:Gs,useExisting:us(()=>n),multi:!0}])],decls:1,vars:1,consts:[["type","number","step","0.01","pInputText","",3,"input","value"]],template:function(t,i){t&1&&(p(0,"input",0),M("input",function(s){return i.onInput(s)}),m()),t&2&&T("value",i.value)},dependencies:[se,re,le,he,ae,ln,pe,ge,oe,ye,ue,_e,be,de,me,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,ke,ce,Pe,Oe],encapsulation:2})};var Fp=()=>["0","1","2","3","4","5","6","7","8"];function Rp(n,e){if(n&1){let t=ee();F(0,"div",14),p(1,"div",3)(2,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.x,o)||(s.x=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(3,"div",3)(4,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.y,o)||(s.y=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(5,"div",3)(6,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.radius,o)||(s.radius=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(7,"div",3)(8,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.maxArea,o)||(s.maxArea=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(9,"div",3),p(10,"div",14)(11,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeRefinementPoint(o))}),m()()}if(n&2){let t=e.$implicit;b(2),P("ngModel",t.x),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.y),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.radius),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.maxArea),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(3),T("outlined",!0)}}function Vp(n,e){if(n&1){let t=ee();p(0,"div",14)(1,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.x,o)||(s.x=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",14)(3,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.y,o)||(s.y=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(4,"div",3)(5,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(6,"div",22),p(7,"div",14)(8,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeResultPoint(o))}),m()()}if(n&2){let t=e.$implicit;b(),P("ngModel",t.x),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.y),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.name),b(3),T("outlined",!0)}}function Bp(n,e){if(n&1){let t=ee();p(0,"div",3)(1,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",15)(3,"p-inputnumber",30),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.modulusOfElasticity,o)||(s.modulusOfElasticity=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(4,"div",3)(5,"p-inputnumber",30),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.weight,o)||(s.weight=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(6,"div",3)(7,"p-inputnumber",31),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.poissonsRatio,o)||(s.poissonsRatio=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(8,"div",3),p(9,"div",14)(10,"p-button",32),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeMaterialAndThickeness(o))}),m()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.name),b(2),P("ngModel",t.modulusOfElasticity),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1)("min",1e-5),b(2),P("ngModel",t.weight),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1)("min",1e-5),b(2),P("ngModel",t.poissonsRatio),T("showButtons",!1)("min",1e-5)("minFractionDigits",1)("max",1)("step",.1),b(3),T("outlined",!0)("disabled",i.model.materials.length<=1)}}function Gp(n,e){if(n&1){let t=ee();p(0,"div",3)(1,"p-inputnumber",30),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.thickness,o)||(s.thickness=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",3)(3,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(4,"div",22),p(5,"div",14)(6,"p-button",32),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeMaterialAndThickeness(o))}),m()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.thickness),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1)("min",1e-5),b(2),P("ngModel",t.name),b(3),T("outlined",!0)("disabled",i.model.sectionProperties.length<=1)}}function jp(n,e){if(n&1){let t=ee();p(0,"div",14)(1,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.x,o)||(s.x=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",14)(3,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.y,o)||(s.y=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(4,"div",14)(5,"p-inputnumber",30),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.width,o)||(s.width=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(6,"div",14)(7,"p-inputnumber",33),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.height,o)||(s.height=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(8,"div",3)(9,"p-select",34),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.sectionName,o)||(s.sectionName=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(10,"div",3)(11,"p-select",34),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.materialName,o)||(s.materialName=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(12,"div",3)(13,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(14,"div",14),p(15,"div",14)(16,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeRectangleGeometry(o))}),m()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.x),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.y),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.width),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1)("min",1e-5),b(2),P("ngModel",t.height),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1)("min",1e-5),b(2),T("options",i.model.sectionProperties),P("ngModel",t.sectionName),b(2),T("options",i.model.materials),P("ngModel",t.materialName),b(2),P("ngModel",t.name),b(3),T("outlined",!0)}}function $p(n,e){if(n&1){let t=ee();p(0,"div",5)(1,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.points,o)||(s.points=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",3)(3,"p-select",34),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.sectionName,o)||(s.sectionName=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(4,"div",3)(5,"p-select",34),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.materialName,o)||(s.materialName=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(6,"div",3)(7,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(8,"div",14),p(9,"div",14)(10,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removePolygonGeometry(o))}),m()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.points),b(2),T("options",i.model.sectionProperties),P("ngModel",t.sectionName),b(2),T("options",i.model.materials),P("ngModel",t.materialName),b(2),P("ngModel",t.name),b(3),T("outlined",!0)}}function qp(n,e){if(n&1){let t=ee();p(0,"div",3)(1,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.x,o)||(s.x=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(2,"div",3)(3,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.y,o)||(s.y=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(4,"div",14)(5,"p-checkbox",35),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fixedX,o)||(s.fixedX=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),p(6,"div",14)(7,"p-checkbox",35),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fixedY,o)||(s.fixedY=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(8,"div",25),p(9,"div",14)(10,"p-button",32),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeRestraint(o))}),m()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.x),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.y),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.fixedX),T("binary",!0),b(2),P("ngModel",t.fixedY),T("binary",!0),b(3),T("outlined",!0)("disabled",i.model.supports.length<=1)}}function Wp(n,e){if(n&1){let t=ee();p(0,"div",41)(1,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.x,o)||(s.x=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),p(2,"div",3)(3,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.y,o)||(s.y=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),p(4,"div",3)(5,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fx,o)||(s.fx=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),p(6,"div",3)(7,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fy,o)||(s.fy=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),F(8,"div",3),p(9,"div",14)(10,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v().$index,r=v();return C(r.removePointLoad(s,o))}),m()()}if(n&2){let t=e.$implicit;b(),P("ngModel",t.x),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.y),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.fx),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.fy),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(3),T("outlined",!0)}}function Kp(n,e){if(n&1){let t=ee();p(0,"div",42)(1,"p-select",45),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.geometryName,o)||(s.geometryName=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),p(2,"div",3)(3,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fx,o)||(s.fx=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),p(4,"div",3)(5,"p-inputnumber",27),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.fy,o)||(s.fy=o),C(o)}),M("ngModelChange",function(){w(t);let o=v(2);return C(o.onChange())}),m()(),F(6,"div",15),p(7,"div",14)(8,"p-button",28),M("onClick",function(){let o=w(t).$index,s=v().$index,r=v();return C(r.removeDistributedLoad(s,o))}),m()()}if(n&2){let t=e.$implicit,i=v(2);b(),T("options",i.geometries),P("ngModel",t.geometryName),b(2),P("ngModel",t.fx),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(2),P("ngModel",t.fy),T("minFractionDigits",0)("maxFractionDigits",5)("showButtons",!1),b(3),T("outlined",!0)}}function Up(n,e){if(n&1){let t=ee();p(0,"div",15)(1,"input",29),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.name,o)||(s.name=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(2,"div",12),p(3,"div",14)(4,"p-button",32),M("onClick",function(){let o=w(t).$index,s=v();return C(s.removeLoadCase(o))}),m()(),p(5,"div",36)(6,"div",37)(7,"p",4),S(8,"Dead Load"),m()(),p(9,"div",14)(10,"p-toggleswitch",38),I("ngModelChange",function(o){let s=w(t).$implicit;return O(s.includeDeadLoad,o)||(s.includeDeadLoad=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m()(),F(11,"div",12),p(12,"div",39)(13,"p",4),S(14,"Point loads"),m()(),F(15,"div",40),p(16,"div",41)(17,"p",4),S(18,"X"),m()(),p(19,"div",3)(20,"p",4),S(21,"Y"),m()(),p(22,"div",3)(23,"p",4),S(24,"FX"),m()(),p(25,"div",3)(26,"p",4),S(27,"FY"),m()(),F(28,"div",5),De(29,Wp,11,17,null,null,Ae),p(31,"div",42)(32,"p-button",43),M("onClick",function(){let o=w(t).$index,s=v();return C(s.addPointLoad(o))}),m()()(),p(33,"div",36)(34,"div",39)(35,"p",4),S(36,"Distributed loads"),m()(),F(37,"div",40),p(38,"div",42)(39,"p",4),S(40,"Geometry name"),m()(),p(41,"div",3)(42,"p",4),S(43,"FX"),m()(),p(44,"div",3)(45,"p",4),S(46,"FY"),m()(),F(47,"div",15),De(48,Kp,9,11,null,null,Ae),p(50,"div",42)(51,"p-button",44),M("onClick",function(){let o=w(t).$index,s=v();return C(s.addDistributedLoad(o))}),m()()()}if(n&2){let t=e.$implicit,i=v();b(),P("ngModel",t.name),b(3),T("outlined",!0)("disabled",i.model.loadCases.length<=1),b(6),P("ngModel",t.includeDeadLoad),b(19),Fe(t.pointLoads),b(19),Fe(t.distributedLoads)}}var Cn=class n extends st{membraneMessageService=Y(Ct);membraneService=Y(di);detector=Y(qe);route=Y(xs);ngOnInit(){this.membraneMessageService.updateGeometry(this.model),this.membraneMessageService.geometryChanged.pipe($e(this.destroyed$)).subscribe(e=>{this.model=e,this.detector.detectChanges()}),this.route.queryParamMap.subscribe(e=>{if(e.keys.length===0)return;let t=e.keys.map(o=>`${o}=${e.get(o)}`).join("&"),i=ut.parseRaw(t||"");this.membraneService.updateGeometry(i)})}rectangles=["0,0,300,100,rec1","300,300,100,100,rec2"];model={solverConfiguration:{solverType:"lusolve"},meshingConfiguration:{maxMeshArea:.05,refinementPoints:[{x:0,y:0,radius:.4,maxArea:.01},{x:1.5,y:0,radius:.4,maxArea:.01},{x:2,y:1,radius:.4,maxArea:.005}]},resultPoints:[{x:1,y:.5,name:"p1"}],sectionProperties:[oi({},yn),ss(oi({},yn),{name:"thickness-2",thickness:.5})],materials:[oi({},er)],rectangles:[{name:"geo1",x:0,y:0,width:2,height:1,sectionName:"default-section",materialName:"default-material"},{name:"geo2",x:3,y:1,width:2,height:2,sectionName:"default-section",materialName:"default-material"},{name:"geo3",x:6,y:0,width:2,height:1,sectionName:"default-section",materialName:"default-material"},{name:"geo4",x:3.45,y:3,width:1,height:.28,sectionName:"default-section",materialName:"default-material"}],polygons:[{name:"pol1",points:"2,0 3,1 3,3 2,1",sectionName:"default-section",materialName:"default-material"},{name:"pol2",points:"5,1 6,0 6,1 5,3",sectionName:"default-section",materialName:"default-material"}],supports:[{x:2,y:0,fixedX:!0,fixedY:!0},{x:6,y:0,fixedX:!1,fixedY:!0}],loadCases:[{name:"loadCase1",includeDeadLoad:!1,pointLoads:[{x:1,y:.48,fx:0,fy:0},{x:2,y:0,fx:0,fy:-1}],distributedLoads:[{geometryName:"geo1",fx:0,fy:-.5}]},{name:"loadCase2",includeDeadLoad:!1,pointLoads:[{x:.72,y:.5,fx:0,fy:0},{x:.5,y:.54,fx:0,fy:0}],distributedLoads:[{geometryName:"geo2",fx:0,fy:-1},{geometryName:"geo2",fx:0,fy:-1}]}]};get geometries(){let e=this.model.rectangles.map(i=>i.name),t=this.model.polygons?.map(i=>i.name)??[];return(0,el.default)([...e,...t])}removeMaterialAndThickeness(e){return W(this,null,function*(){this.model.sectionProperties.splice(e,1),yield this.onChange()})}addMaterialAndThickeness(){return W(this,null,function*(){this.model.sectionProperties.push(oi({},yn)),yield this.onChange()})}addResultPoint(){return W(this,null,function*(){this.model.resultPoints.push({x:0,y:0,name:`p${this.model.resultPoints.length+1}`}),yield this.onChange()})}removeRectangleGeometry(e){return W(this,null,function*(){this.model.rectangles.splice(e,1),yield this.onChange()})}removePolygonGeometry(e){return W(this,null,function*(){this.model.polygons.splice(e,1),yield this.onChange()})}removeResultPoint(e){return W(this,null,function*(){this.model.resultPoints.splice(e,1),yield this.onChange()})}addRectangleGeometry(){return W(this,null,function*(){this.model.rectangles.push(oi({},Bs)),yield this.onChange()})}addPolygonGeometry(){return W(this,null,function*(){this.model.polygons.push(oi({},Vs)),yield this.onChange()})}removeRestraint(e){return W(this,null,function*(){this.model.supports.splice(e,1),yield this.onChange()})}removeRefinementPoint(e){return W(this,null,function*(){this.model.meshingConfiguration.refinementPoints.splice(e,1),yield this.onChange()})}addRefinementPoint(){return W(this,null,function*(){this.model.meshingConfiguration.refinementPoints.push({x:0,y:0,radius:.1,maxArea:.001}),yield this.onChange()})}addRestraint(){return W(this,null,function*(){this.model.supports.push({x:0,y:0,fixedX:!0,fixedY:!0}),yield this.onChange()})}addLoadCase(){return W(this,null,function*(){this.model.loadCases.push({name:`loadCase${this.model.loadCases.length+1}`,pointLoads:[],distributedLoads:[],includeDeadLoad:!1}),yield this.onChange()})}removeLoadCase(e){return W(this,null,function*(){this.model.loadCases.splice(e,1),yield this.onChange()})}addPointLoad(e){return W(this,null,function*(){this.model.loadCases[e].pointLoads.push({x:0,y:0,fx:0,fy:0}),yield this.onChange()})}removePointLoad(e,t){return W(this,null,function*(){this.model.loadCases[e].pointLoads.splice(t,1),yield this.onChange()})}addDistributedLoad(e){return W(this,null,function*(){this.model.loadCases[e].distributedLoads.push({geometryName:"",fx:0,fy:0}),yield this.onChange()})}removeDistributedLoad(e,t){return W(this,null,function*(){this.model.loadCases[e].distributedLoads.splice(t,1),yield this.onChange()})}onChange(){return W(this,null,function*(){yield Promise.resolve(),this.membraneService.updateGeometry(this.model),this.detector.detectChanges()})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=bt(n)))(i||n)}})();static \u0275cmp=ne({type:n,selectors:[["app-geometry"]],features:[wt],decls:210,vars:6,consts:[[3,"value","multiple"],["value","0"],[1,"grid","grid-cols-12","gap-2","auto-rows-max","mt-1","mb-1"],[1,"col-span-2"],[1,"font-semibold"],[1,"col-span-4"],["name","lusolve1","value","lusolve","inputId","lusolve1",3,"ngModelChange","ngModel"],["for","lusolve1",1,"ml-2"],["name","iterative1","value","iterative","inputId","iterative",3,"ngModelChange","ngModel"],["for","iterative1",1,"ml-2"],["value","1"],["type","number","step","0.01",3,"ngModelChange","ngModel"],[1,"col-span-8"],[1,"col-span-12"],[1,"col-span-1"],[1,"col-span-3"],[1,"col-span-1","col-start-2"],["severity","secondary","size","small","icon","pi pi-plus","label","Add",3,"onClick"],["value","5"],[1,"mt-2"],["value","3"],["value","4"],[1,"col-span-7"],["value","6"],["value","7"],[1,"col-span-5"],["value","8"],["mode","decimal",3,"ngModelChange","ngModel","minFractionDigits","maxFractionDigits","showButtons"],["severity","secondary","icon","pi pi-times","severity","danger",3,"onClick","outlined"],["type","text","pInputText","",3,"ngModelChange","ngModel"],["mode","decimal",3,"ngModelChange","ngModel","minFractionDigits","maxFractionDigits","showButtons","min"],["mode","decimal",3,"ngModelChange","ngModel","showButtons","min","minFractionDigits","max","step"],["severity","secondary","icon","pi pi-times","severity","danger",3,"onClick","outlined","disabled"],[3,"ngModelChange","ngModel","minFractionDigits","maxFractionDigits","showButtons","min"],["optionLabel","name","placeholder","Select material and thickness","optionValue","name",3,"ngModelChange","options","ngModel"],[3,"ngModelChange","ngModel","binary"],[1,"col-span-12","grid","grid-cols-subgrid","gap-2"],[1,"col-start-2","col-span-2"],[3,"ngModelChange","ngModel"],[1,"col-span-4","col-start-2"],[1,"col-span-6"],[1,"col-span-2","col-start-2"],[1,"col-span-3","col-start-2"],["severity","secondary","icon","pi pi-plus","size","small","label","Add point load",3,"onClick"],["severity","secondary","size","small","icon","pi pi-plus","label","Add distributed load",3,"onClick"],["placeholder","Select geometry",3,"ngModelChange","options","ngModel"]],template:function(t,i){t&1&&(p(0,"p-accordion",0)(1,"p-accordion-panel",1)(2,"p-accordion-header"),S(3,"Solver Configuration"),m(),p(4,"p-accordion-content")(5,"p-fluid")(6,"div",2)(7,"div",3)(8,"p",4),S(9,"Solver type"),m()(),p(10,"div",5)(11,"p-radiobutton",6),I("ngModelChange",function(s){return O(i.model.solverConfiguration.solverType,s)||(i.model.solverConfiguration.solverType=s),s}),M("ngModelChange",function(){return i.onChange()}),m(),p(12,"label",7),S(13,"Lu Solve"),m()(),p(14,"div",5)(15,"p-radiobutton",8),I("ngModelChange",function(s){return O(i.model.solverConfiguration.solverType,s)||(i.model.solverConfiguration.solverType=s),s}),M("ngModelChange",function(){return i.onChange()}),m(),p(16,"label",9),S(17,"Iterative"),m()(),F(18,"div",3),m()()()(),p(19,"p-accordion-panel",10)(20,"p-accordion-header"),S(21,"Meshing Configuration"),m(),p(22,"p-accordion-content")(23,"p-fluid")(24,"div",2)(25,"div",3)(26,"p",4),S(27,"Max mesh area"),m()(),p(28,"div",3)(29,"app-input-number",11),I("ngModelChange",function(s){return O(i.model.meshingConfiguration.maxMeshArea,s)||(i.model.meshingConfiguration.maxMeshArea=s),s}),M("ngModelChange",function(){return i.onChange()}),m()(),F(30,"div",12),p(31,"div",13)(32,"p",4),S(33,"Refinement Points"),m()(),F(34,"div",14),p(35,"div",3)(36,"p",4),S(37,"X"),m()(),p(38,"div",3)(39,"p",4),S(40,"Y"),m()(),p(41,"div",3)(42,"p",4),S(43,"Radious"),m()(),p(44,"div",3)(45,"p",4),S(46,"Max mesh size"),m()(),F(47,"div",15),De(48,Rp,12,17,null,null,Ae),p(50,"div",16)(51,"p-button",17),M("onClick",function(){return i.addRefinementPoint()}),m()()()()()(),p(52,"p-accordion-panel",18)(53,"p-accordion-header"),S(54,"Result points"),m(),p(55,"p-accordion-content")(56,"p-fluid")(57,"div",2)(58,"div",14)(59,"p",4),S(60,"x"),m()(),p(61,"div",14)(62,"p",4),S(63,"y"),m()(),p(64,"div",3)(65,"p",4),S(66,"Name"),m()(),F(67,"div",12),De(68,Vp,9,10,null,null,Ae),m()(),p(70,"div",19)(71,"p-button",17),M("onClick",function(){return i.addResultPoint()}),m()()()(),p(72,"p-accordion-panel",20)(73,"p-accordion-header"),S(74,"Material"),m(),p(75,"p-accordion-content")(76,"p-fluid")(77,"div",2)(78,"div",3)(79,"p",4),S(80,"Name"),m()(),p(81,"div",15)(82,"p",4),S(83,"Modulus of elasticity"),m()(),p(84,"div",3)(85,"p",4),S(86,"Weight"),m()(),p(87,"div",3)(88,"p",4),S(89,"Poison's ratio"),m()(),F(90,"div",3)(91,"div",14),De(92,Bp,11,19,null,null,Ae),m()(),p(94,"div",19)(95,"p-button",17),M("onClick",function(){return i.addMaterialAndThickeness()}),m()()()(),p(96,"p-accordion-panel",21)(97,"p-accordion-header"),S(98,"Section"),m(),p(99,"p-accordion-content")(100,"p-fluid")(101,"div",2)(102,"div",3)(103,"p",4),S(104,"Thickness"),m()(),p(105,"div",3)(106,"p",4),S(107,"Name"),m()(),F(108,"div",22)(109,"div",14),De(110,Gp,7,8,null,null,Ae),m()(),p(112,"div",19)(113,"p-button",17),M("onClick",function(){return i.addMaterialAndThickeness()}),m()()()(),p(114,"p-accordion-panel",18)(115,"p-accordion-header"),S(116,"Rectangle geometry"),m(),p(117,"p-accordion-content")(118,"p-fluid")(119,"div",2)(120,"div",14)(121,"p",4),S(122,"x0"),m()(),p(123,"div",14)(124,"p",4),S(125,"y0"),m()(),p(126,"div",14)(127,"p",4),S(128,"Width"),m()(),p(129,"div",14)(130,"p",4),S(131,"Height"),m()(),p(132,"div",3)(133,"p",4),S(134,"Section"),m()(),p(135,"div",3)(136,"p",4),S(137,"Material"),m()(),p(138,"div",3)(139,"p",4),S(140,"Name"),m()(),F(141,"div",14)(142,"div",14),De(143,jp,17,24,null,null,Ae),m()(),p(145,"div",19)(146,"p-button",17),M("onClick",function(){return i.addRectangleGeometry()}),m()()()(),p(147,"p-accordion-panel",23)(148,"p-accordion-header"),S(149,"Polygon geometry"),m(),p(150,"p-accordion-content")(151,"p-fluid")(152,"div",2)(153,"div",5)(154,"p",4),S(155,"Coordinates (x1,y1 x2,y2 ..)"),m()(),p(156,"div",3)(157,"p",4),S(158,"Section"),m()(),p(159,"div",3)(160,"p",4),S(161,"Material"),m()(),p(162,"div",3)(163,"p",4),S(164,"Name"),m()(),F(165,"div",14)(166,"div",14),De(167,$p,11,7,null,null,Ae),m()(),p(169,"div",19)(170,"p-button",17),M("onClick",function(){return i.addPolygonGeometry()}),m()()()(),p(171,"p-accordion-panel",24)(172,"p-accordion-header"),S(173,"Supports"),m(),p(174,"p-accordion-content")(175,"p-fluid")(176,"div",2)(177,"div",3)(178,"p",4),S(179,"X"),m()(),p(180,"div",3)(181,"p",4),S(182,"Y"),m()(),p(183,"div",14)(184,"p",4),S(185,"Fixed X"),m()(),p(186,"div",14)(187,"p",4),S(188,"Fixed Y"),m()(),F(189,"div",25)(190,"div",14),De(191,qp,11,14,null,null,Ae),m()(),p(193,"div",19)(194,"p-button",17),M("onClick",function(){return i.addRestraint()}),m()()()(),p(195,"p-accordion-panel",26)(196,"p-accordion-header"),S(197,"Load cases"),m(),p(198,"p-accordion-content")(199,"p-fluid")(200,"div",2)(201,"div",15)(202,"p",4),S(203,"Name"),m()(),F(204,"div",12)(205,"div",14),De(206,Up,52,4,null,null,Ae),m()(),p(208,"div",19)(209,"p-button",17),M("onClick",function(){return i.addLoadCase()}),m()()()()()),t&2&&(T("value",on(5,Fp))("multiple",!0),b(11),P("ngModel",i.model.solverConfiguration.solverType),b(4),P("ngModel",i.model.solverConfiguration.solverType),b(14),P("ngModel",i.model.meshingConfiguration.maxMeshArea),b(19),Fe(i.model.meshingConfiguration.refinementPoints),b(20),Fe(i.model.resultPoints),b(24),Fe(i.model.materials),b(18),Fe(i.model.sectionProperties),b(33),Fe(i.model.rectangles),b(24),Fe(i.model.polygons),b(24),Fe(i.model.supports),b(15),Fe(i.model.loadCases))},dependencies:[se,re,le,fi,hn,he,ae,ln,pe,cn,ge,oe,an,nt,ot,ye,dn,mn,pn,un,ue,_e,be,de,hi,me,St,we,Ce,Se,Me,ve,fn,xe,fe,Ys,Te,Ee,Ne,ke,ce,Pe,Oe,wn],encapsulation:2,changeDetection:0})};var nl=po(Ql());var Yp=["LoadCase","GeometryName","ElementIndex","NodeIndex","ResultPoint","NodeX","NodeY","uX","uY","ReactionX","ReactionY","Sxx","Syy","Sxy"];function tl(n){if(!n||n.length===0)return"";let e=n.flatMap(t=>t.details.map(i=>[t.loadCase,i.geometryName??"",i.elementIndex,i.nodeIndex,i.resultPointName,i.nodeX,i.nodeY,i.uX,i.uY,i.reactionX===0?"":i.reactionX,i.reactionY===0?"":i.reactionY,i.sxx,i.syy,i.sxy]));return[Yp.join(","),...e.map(t=>t.join(","))].join(`
`)}var So=po(Jl()),Hp=(n,e)=>(0,So.default)(n.x,e.x)&&(0,So.default)(n.y,e.y);var il=(n,e)=>n.some(t=>Hp(t,e));var zp=()=>({width:"100%"});function Xp(n,e){n&1&&(p(0,"tr"),F(1,"th",10),p(2,"th"),S(3,"Geometry Name"),m(),p(4,"th"),S(5,"Node index"),m(),p(6,"th"),S(7,"Result Point Name"),m(),p(8,"th"),S(9,"NodeX"),m(),p(10,"th"),S(11,"NodeY"),m()())}function Jp(n,e){if(n&1&&(p(0,"tr")(1,"td"),F(2,"p-button",11),m(),p(3,"td"),S(4),m(),p(5,"td"),S(6),m(),p(7,"td"),S(8),m(),p(9,"td"),S(10),m(),p(11,"td"),S(12),m()()),n&2){let t=e.$implicit,i=e.expanded;b(2),T("pRowToggler",t)("text",!0)("rounded",!0)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),b(2),X(t.geometryName),b(2),X(t.nodeIndex),b(2),X(t.resultPointName),b(2),X(t.nodeX),b(2),X(t.nodeY)}}function Qp(n,e){if(n&1&&(p(0,"tr")(1,"th"),S(2,"uX"),m(),p(3,"td"),S(4),m()(),p(5,"tr")(6,"th"),S(7,"uY"),m(),p(8,"td"),S(9),m()(),p(10,"tr")(11,"th"),S(12,"Rx"),m(),p(13,"td"),S(14),m()(),p(15,"tr")(16,"th"),S(17,"Ry"),m(),p(18,"td"),S(19),m()(),p(20,"tr")(21,"th"),S(22,"Sxx"),m(),p(23,"td"),S(24),m()(),p(25,"tr")(26,"th"),S(27,"Syy"),m(),p(28,"td"),S(29),m()(),p(30,"tr")(31,"th"),S(32,"Sxy"),m(),p(33,"td"),S(34),m()(),F(35,"tr")),n&2){let t=e.$implicit;b(4),X(t.uX),b(5),X(t.uY),b(5),X(t.reactionX),b(5),X(t.reactionY),b(5),X(t.sxx),b(5),X(t.syy),b(5),X(t.sxy)}}function Zp(n,e){if(n&1&&(p(0,"p-accordion-panel",8)(1,"p-accordion-header"),S(2),m(),p(3,"p-accordion-content")(4,"p-table",9),Ue(5,Xp,12,0,"ng-template",null,0,ui)(7,Jp,13,9,"ng-template",null,1,ui)(9,Qp,36,7,"ng-template",null,2,ui),m()()()),n&2){let t=e.$implicit,i=e.$index,o=v(3);T("value",i),b(2),X(t.loadCase),b(2),T("value",t.details)("expandedRowKeys",o.expandedRows)("tableStyle",on(7,zp))("size","small")("scrollable",!0)}}function eu(n,e){if(n&1&&(p(0,"p-accordion",8),De(1,Zp,11,8,"p-accordion-panel",8,Ae),m()),n&2){let t=v(2);T("value",0),b(),Fe(t.resultPointsResults)}}function tu(n,e){if(n&1){let t=ee();p(0,"p-multiselect",3),I("ngModelChange",function(o){w(t);let s=v();return O(s.selectedGeometries,o)||(s.selectedGeometries=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m(),p(1,"p-multiselect",4),I("ngModelChange",function(o){w(t);let s=v();return O(s.selectedLoadCases,o)||(s.selectedLoadCases=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m(),p(2,"label",5),S(3,"Result Points only"),m(),p(4,"p-toggleswitch",6),I("ngModelChange",function(o){w(t);let s=v();return O(s.resultPointsSelected,o)||(s.resultPointsSelected=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onChange())}),m(),p(5,"p"),S(6),m(),p(7,"p-button",7),M("onClick",function(){w(t);let o=v();return C(o.exportCsv())}),m(),Ue(8,eu,3,1,"p-accordion",8)}if(n&2){let t=v();T("options",t.geometries),P("ngModel",t.selectedGeometries),b(),T("options",t.loadCases),P("ngModel",t.selectedLoadCases),b(3),P("ngModel",t.resultPointsSelected),b(2),X(t.uuid),b(2),si(t.resultPointsSelected?8:-1)}}var Sn=class n extends st{messageService=Y(Ct);changeDetector=Y(qe);expandedRows={};visible=!1;loadCases=[];selectedLoadCases=[];geometries=[];selectedGeometries=[];geometry;resultPointsSelected=!1;uuid;results=[];resultPointsResults=[];ngOnInit(){this.messageService.resultsChanged.pipe($e(this.destroyed$),z(e=>this.uuid=e)).subscribe(()=>this.changeDetector.detectChanges()),this.messageService.geometryChanged.pipe($e(this.destroyed$),z(e=>this.loadCases=this.selectedLoadCases=e.loadCases.map(t=>t.name)),z(e=>this.geometries=this.selectedGeometries=e.rectangles.map(t=>t.name)),z(e=>this.geometry=e)).subscribe(()=>this.changeDetector.detectChanges()),this.messageService.resultsChanged.pipe($e(this.destroyed$),ki(e=>e!==""),z(e=>this.visible=e)).subscribe(()=>this.changeDetector.detectChanges()),this.messageService.resultsChanged.pipe($e(this.destroyed$),tn(e=>e!==""),ps(e=>ls({uuid:e,loadcases:[...this.loadCases]}).pipe(cs(t=>ms([...t.loadcases.map(i=>as(nl.getItem(Fs(t.uuid,i))))])),ki(t=>t.filter(i=>i).map(i=>i)))),z(e=>this.results=e??[])).subscribe(()=>this.changeDetector.detectChanges())}onChange(){this.resultPointsSelected&&(this.resultPointsResults=this.filterResults()),this.changeDetector.detectChanges()}exportCsv(){let e=this.resultPointsSelected?this.filterResults():this.results,t=tl(e),i=`results_${new Date().toLocaleTimeString()}_${this.uuid}.csv`,o=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(o),r=document.createElement("a");r.href=s,r.setAttribute("download",i),document.body.appendChild(r),r.click(),document.body.removeChild(r)}filterResults(){return this.results.filter(t=>this.selectedLoadCases.includes(t.loadCase)).filter(t=>t.details.some(i=>this.selectedGeometries.includes(i.geometryName))).map(t=>({details:t.details.filter(o=>this.geometry?.resultPoints?.length===0||il(this.geometry.resultPoints,{x:o.nodeX,y:o.nodeY})),loadCase:t.loadCase}))}static \u0275fac=(()=>{let e;return function(i){return(e||(e=bt(n)))(i||n)}})();static \u0275cmp=ne({type:n,selectors:[["app-results"]],features:[wt],decls:1,vars:1,consts:[["header",""],["body",""],["expandedrow",""],["placeholder","Select geometry",1,"w-full","md:w-80",3,"ngModelChange","options","ngModel"],["placeholder","Select load cases",1,"w-full","md:w-80",3,"ngModelChange","options","ngModel"],["for","resultPointsToggle",1,"p-mr-2"],["id","resultPointsToggle",3,"ngModelChange","ngModel"],["label","Export to csv",3,"onClick"],[3,"value"],["dataKey","resultIdentity","scrollHeight","400px",3,"value","expandedRowKeys","tableStyle","size","scrollable"],[2,"width","5rem"],["type","button","pRipple","","severity","secondary",3,"pRowToggler","text","rounded","icon"]],template:function(t,i){t&1&&Ue(0,tu,9,7),t&2&&si(i.visible?0:-1)},dependencies:[se,re,le,he,Hs,zs,ae,pe,ge,oe,nt,ot,ye,dn,mn,pn,un,ue,_e,be,de,me,St,we,Ce,Se,Me,ve,fn,xe,fe,Te,Ee,Js,Ne,ke,ce,Pe,Oe],styles:["canvas[_ngcontent-%COMP%]{width:800px;height:600px;border:1px solid black}"],changeDetection:0})};var ol={type:"change"},vo={type:"start"},rl={type:"end"},Mn=new Es,sl=new Os,iu=Math.cos(70*Ts.DEG2RAD),te=new Ye,Be=2*Math.PI,K={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Mo=1e-6,vn=class extends As{constructor(e,t=null){super(e,t),this.state=K.NONE,this.target=new Ye,this.cursor=new Ye,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ri.ROTATE,MIDDLE:ri.DOLLY,RIGHT:ri.PAN},this.touches={ONE:ai.ROTATE,TWO:ai.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Ye,this._lastQuaternion=new ho,this._lastTargetPosition=new Ye,this._quat=new ho().setFromUnitVectors(e.up,new Ye(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new go,this._sphericalDelta=new go,this._scale=1,this._panOffset=new Ye,this._rotateStart=new Ve,this._rotateEnd=new Ve,this._rotateDelta=new Ve,this._panStart=new Ve,this._panEnd=new Ve,this._panDelta=new Ve,this._dollyStart=new Ve,this._dollyEnd=new Ve,this._dollyDelta=new Ve,this._dollyDirection=new Ye,this._mouse=new Ve,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ou.bind(this),this._onPointerDown=nu.bind(this),this._onPointerUp=su.bind(this),this._onContextMenu=uu.bind(this),this._onMouseWheel=lu.bind(this),this._onKeyDown=cu.bind(this),this._onTouchStart=mu.bind(this),this._onTouchMove=pu.bind(this),this._onMouseDown=ru.bind(this),this._onMouseMove=au.bind(this),this._interceptControlDown=du.bind(this),this._interceptControlUp=fu.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(ol),this.update(),this.state=K.NONE}update(e=null){let t=this.object.position;te.copy(t).sub(this.target),te.applyQuaternion(this._quat),this._spherical.setFromVector3(te),this.autoRotate&&this.state===K.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(i)&&isFinite(o)&&(i<-Math.PI?i+=Be:i>Math.PI&&(i-=Be),o<-Math.PI?o+=Be:o>Math.PI&&(o-=Be),i<=o?this._spherical.theta=Math.max(i,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+o)/2?Math.max(i,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=r!=this._spherical.radius}if(te.setFromSpherical(this._spherical),te.applyQuaternion(this._quatInverse),t.copy(this.target).add(te),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){let a=te.length();r=this._clampDistance(a*this._scale);let l=a-r;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){let a=new Ye(this._mouse.x,this._mouse.y,0);a.unproject(this.object);let l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;let c=new Ye(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),r=te.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(Mn.origin.copy(this.object.position),Mn.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Mn.direction))<iu?this.object.lookAt(this.target):(sl.setFromNormalAndCoplanarPoint(this.object.up,this.target),Mn.intersectPlane(sl,this.target))))}else if(this.object.isOrthographicCamera){let r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>Mo||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Mo||this._lastTargetPosition.distanceToSquared(this.target)>Mo?(this.dispatchEvent(ol),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Be/60*this.autoRotateSpeed*e:Be/60/60*this.autoRotateSpeed}_getZoomScale(e){let t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){te.setFromMatrixColumn(t,0),te.multiplyScalar(-e),this._panOffset.add(te)}_panUp(e,t){this.screenSpacePanning===!0?te.setFromMatrixColumn(t,1):(te.setFromMatrixColumn(t,0),te.crossVectors(this.object.up,te)),te.multiplyScalar(e),this._panOffset.add(te)}_pan(e,t){let i=this.domElement;if(this.object.isPerspectiveCamera){let o=this.object.position;te.copy(o).sub(this.target);let s=te.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let i=this.domElement.getBoundingClientRect(),o=e-i.left,s=t-i.top,r=i.width,a=i.height;this._mouse.x=o/r*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(Be*this._rotateDelta.x/t.clientHeight),this._rotateUp(Be*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Be*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._rotateStart.set(i,o)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._panStart.set(i,o)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),i=e.pageX-t.x,o=e.pageY-t.y,s=Math.sqrt(i*i+o*o);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{let i=this._getSecondPointerPosition(e),o=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateEnd.set(o,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(Be*this._rotateDelta.x/t.clientHeight),this._rotateUp(Be*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._panEnd.set(i,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),i=e.pageX-t.x,o=e.pageY-t.y,s=Math.sqrt(i*i+o*o);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let r=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new Ve,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}};function nu(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function ou(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function su(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(rl),this.state=K.NONE;break;case 1:let e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function ru(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case ri.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=K.DOLLY;break;case ri.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=K.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=K.ROTATE}break;case ri.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=K.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=K.PAN}break;default:this.state=K.NONE}this.state!==K.NONE&&this.dispatchEvent(vo)}function au(n){switch(this.state){case K.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case K.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case K.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function lu(n){this.enabled===!1||this.enableZoom===!1||this.state!==K.NONE||(n.preventDefault(),this.dispatchEvent(vo),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(rl))}function cu(n){this.enabled!==!1&&this._handleKeyDown(n)}function mu(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case ai.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=K.TOUCH_ROTATE;break;case ai.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=K.TOUCH_PAN;break;default:this.state=K.NONE}break;case 2:switch(this.touches.TWO){case ai.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=K.TOUCH_DOLLY_PAN;break;case ai.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=K.TOUCH_DOLLY_ROTATE;break;default:this.state=K.NONE}break;default:this.state=K.NONE}this.state!==K.NONE&&this.dispatchEvent(vo)}function pu(n){switch(this._trackPointer(n),this.state){case K.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case K.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case K.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case K.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=K.NONE}}function uu(n){this.enabled!==!1&&n.preventDefault()}function du(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function fu(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var hu=n=>({background:n});function gu(n,e){if(n&1){let t=ee();p(0,"div",1)(1,"div")(2,"p"),S(3),m()(),p(4,"div",2),F(5,"div",3),p(6,"div",4)(7,"div")(8,"p-inputnumber",5),I("ngModelChange",function(o){w(t);let s=v();return O(s.max,o)||(s.max=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onExtermeValuesChanged())}),m()(),p(9,"div"),S(10),ws(11,"number"),m(),p(12,"div")(13,"p-inputnumber",6),I("ngModelChange",function(o){w(t);let s=v();return O(s.min,o)||(s.min=o),C(o)}),M("ngModelChange",function(){w(t);let o=v();return C(o.onExtermeValuesChanged())}),m()()()()()}if(n&2){let t=v();b(3),nn("Max disp: ",t.maxDisp,""),b(2),T("ngStyle",bs(10,hu,t.gradient)),b(3),P("ngModel",t.max),T("useGrouping",!1),b(2),X(Cs(11,7,t.middle,"1.2-2")),b(3),P("ngModel",t.min),T("useGrouping",!1)}}var xn=class n{subscription;legendService=Y(Rs);detector=Y(qe);gradient="";min=0;middle=0;max=0;maxDisp=0;visible=!1;constructor(){}ngOnDestroy(){this.subscription?.unsubscribe()}ngOnInit(){this.subscription=this.legendService.extremeValuesChanged.pipe(z(e=>this.visible=!(e.maxStress===0&&e.minStress==0)),z(()=>this.detector.detectChanges()),tn(e=>e.maxStress!==0&&e.minStress!==0),z(e=>this.max=e.maxStress),z(e=>this.min=e.minStress),z(e=>this.middle=(e.maxStress+e.minStress)/2),z(e=>this.maxDisp=e.maxDisp),ki(()=>this.legendService.getColorRange()),z(e=>this.buildGradient(e)),z(()=>this.detector.detectChanges())).subscribe(),this.detector.detectChanges()}onExtermeValuesChanged(){Number.isFinite(this.min)&&Number.isFinite(this.max)&&this.min<this.max&&(this.middle=(this.max+this.min)/2,this.legendService.setLegendChanged(this.min,this.max))}buildGradient(e){let t=e.reverse().join(", ");this.gradient=`linear-gradient(to bottom, ${t})`}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ne({type:n,selectors:[["app-legend"]],decls:1,vars:1,consts:[["class","legend",4,"ngIf"],[1,"legend"],[1,"flex"],[1,"gradient-map",3,"ngStyle"],[1,"flex","justify-between","flex-col","mx-1"],["mode","decimal","inputId","legend_max",3,"ngModelChange","ngModel","useGrouping"],["mode","decimal","inputId","legend_min",3,"ngModelChange","ngModel","useGrouping"]],template:function(t,i){t&1&&Ue(0,gu,14,12,"div",0),t&2&&T("ngIf",i.visible)},dependencies:[se,re,le,fi,he,ae,pe,ge,oe,nt,ot,ye,ue,_e,be,de,me,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,ke,ce,Pe,Oe,vs,Ms,Ss],styles:[".legend[_ngcontent-%COMP%]{position:relative}.legend[_ngcontent-%COMP%]   .gradient-map[_ngcontent-%COMP%]{height:300px;width:50px}"],changeDetection:0})};var Tn=class n{detector=Y(qe);view3dService=Y(rn);sub;config;model={selectedLoadCase:this.config?.loadCases?this.config.loadCases[0]:"",selectedResultType:this.config?.resultTypes?this.config.resultTypes[0]:null,displacementScaleFactor:1};ngOnInit(){return W(this,null,function*(){this.sub=this.view3dService.menuConfigurationChanged.subscribe(e=>{this.config=e,this.model.selectedLoadCase=this.config.loadCases[0],this.model.selectedResultType=this.config.resultTypes?this.config.resultTypes[0]:null,this.detector.detectChanges()}),yield this.onChange()})}ngOnDestroy(){this.sub?.unsubscribe()}onChange(){return W(this,null,function*(){yield this.view3dService.setConfiguration(this.model)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ne({type:n,selectors:[["app-view3d-menu"]],decls:16,vars:8,consts:[[1,"grid","grid-cols-12","gap-2","auto-rows-max","mt-1","mb-1"],[1,"col-span-3"],["for","in_result_type",1,"font-semibold"],["id","in_result_type","placeholder","Select result",3,"ngModelChange","options","ngModel"],["for","in_load_case",1,"font-semibold"],["id","in_load_case","placeholder","Select load case",3,"ngModelChange","options","ngModel"],[1,"font-semibold"],["id","Displacement_scale","mode","decimal","inputId","minmax-buttons",3,"ngModelChange","ngModel","showButtons","min","max"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"div",1)(2,"p-fluid")(3,"p",2),S(4,"Result type"),m(),p(5,"p-select",3),I("ngModelChange",function(s){return O(i.model.selectedResultType,s)||(i.model.selectedResultType=s),s}),M("ngModelChange",function(){return i.onChange()}),m()()(),p(6,"div",1)(7,"p-fluid")(8,"p",4),S(9,"Load Case"),m(),p(10,"p-select",5),I("ngModelChange",function(s){return O(i.model.selectedLoadCase,s)||(i.model.selectedLoadCase=s),s}),M("ngModelChange",function(){return i.onChange()}),m()()(),p(11,"div",1)(12,"p-fluid")(13,"p",6),S(14,"Displacement scale"),m(),p(15,"p-inputnumber",7),I("ngModelChange",function(s){return O(i.model.displacementScaleFactor,s)||(i.model.displacementScaleFactor=s),s}),M("ngModelChange",function(){return i.onChange()}),m()()()()),t&2&&(b(5),T("options",i.config==null?null:i.config.resultTypes),P("ngModel",i.model.selectedResultType),b(5),T("options",i.config==null?null:i.config.loadCases),P("ngModel",i.model.selectedLoadCase),b(5),P("ngModel",i.model.displacementScaleFactor),T("showButtons",!0)("min",0)("max",100))},dependencies:[se,re,le,fi,hn,he,ae,pe,ge,oe,nt,ot,ye,ue,_e,be,de,hi,me,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,ke,ce,Pe,Oe],encapsulation:2,changeDetection:0})};var yu=["canvasView3d"],_u=["view3d_tooltip"],bu="white",En=class n{canvasContainer=uo("canvasView3d");tooltipRef=uo("view3d_tooltip");tooltip;view3DService=Y(rn);zone=Y(ds);frameId;scene;camera;renderer;orbitControls;raycaster=new Is;ngAfterViewInit(){this.initThreeJs(),this.animate()}ngOnInit(){}ngOnDestroy(){cancelAnimationFrame(this.frameId),this.renderer?.dispose(),this.orbitControls?.dispose()}onResize(){let e=this.canvasContainer();if(!e){console.error("Canvas element not found");return}let t=e.nativeElement.clientWidth,i=e.nativeElement.clientHeight;this.camera.aspect=t/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,i)}onMouseMove(e){e.preventDefault();let t=this.view3DService.getMeshForRaycasting();if(!t)return;let i=this.renderer.domElement.getBoundingClientRect(),o=new Ve;o.x=(e.clientX-i.left)/i.width*2-1,o.y=-((e.clientY-i.top)/i.height)*2+1,this.raycaster.setFromCamera(o,this.camera);let s=this.raycaster.intersectObject(t);if(s.length>0){let r=s[0],a=Math.floor(r.faceIndex/1),c=this.view3DService.getResults(a).map(f=>`<b>${f.nodeIndex}: ${f.value}</b><br/> `).reduce((f,d)=>`${f}${d}`,"");this.tooltip.style.display="block",this.tooltip.style.left=`${e.offsetX+8}px`,this.tooltip.style.top=`${e.offsetY+8}px`,this.tooltip.innerHTML=c}else this.tooltip.style.display="none"}initThreeJs(){this.scene=new Ps;let e=this.canvasContainer();if(!e){console.error("Canvas element not found");return}let t=e.nativeElement,i=1,o=t.clientWidth-1,s=i*t.clientWidth;this.camera=new ks(75,o/s,.01,1e6),this.camera.position.z=10,this.camera.position.x=0,this.camera.position.y=0,this.renderer=new Ds,this.scene.background=new Ns(bu),this.renderer.setSize(o,s),e.nativeElement.appendChild(this.renderer.domElement);let r=new Ls(500);this.scene.add(r),this.orbitControls=new vn(this.camera,this.renderer.domElement),this.view3DService.injectScene(this.scene),this.tooltip=this.tooltipRef()?.nativeElement,this.tooltip.style.position="absolute",this.tooltip.style.background="rgba(0,0,0,0.8)",this.tooltip.style.color="#fff",this.tooltip.style.padding="4px 8px",this.tooltip.style.borderRadius="4px",this.tooltip.style.pointerEvents="none",this.tooltip.style.display="none",this.tooltip.style.fontFamily="monospace"}animate=()=>{this.frameId=this.zone.runOutsideAngular(()=>requestAnimationFrame(this.animate)),this.orbitControls.update(),this.renderer.render(this.scene,this.camera)};static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ne({type:n,selectors:[["app-view3d"]],viewQuery:function(t,i){t&1&&(fo(i.canvasContainer,yu,5),fo(i.tooltipRef,_u,5)),t&2&&ys(2)},hostBindings:function(t,i){t&1&&M("resize",function(){return i.onResize()},!1,fs)},decls:8,vars:0,consts:[["canvasView3d",""],["view3d_tooltip",""],[1,"container",2,"width","100%","height","90vh","display","flex","position","relative",3,"mousemove"],[1,"legend"]],template:function(t,i){if(t&1){let o=ee();p(0,"div"),F(1,"app-view3d-menu"),m(),p(2,"div",2,0),M("mousemove",function(r){return w(o),C(i.onMouseMove(r))}),p(4,"div",3),F(5,"app-legend"),m(),F(6,"div",null,1),m()}},dependencies:[xn,Tn,se,re,le,he,ae,pe,ge,oe,ye,ue,_e,be,de,me,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,ke,ce,Pe,Oe],styles:[".container[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{position:absolute;top:0;left:0}"]})};var Nn=Symbol.for("yaml.alias"),kn=Symbol.for("yaml.document"),He=Symbol.for("yaml.map"),xo=Symbol.for("yaml.pair"),je=Symbol.for("yaml.scalar"),dt=Symbol.for("yaml.seq"),Re=Symbol.for("yaml.node.type"),We=n=>!!n&&typeof n=="object"&&n[Re]===Nn,ze=n=>!!n&&typeof n=="object"&&n[Re]===kn,Xe=n=>!!n&&typeof n=="object"&&n[Re]===He,j=n=>!!n&&typeof n=="object"&&n[Re]===xo,G=n=>!!n&&typeof n=="object"&&n[Re]===je,Je=n=>!!n&&typeof n=="object"&&n[Re]===dt;function q(n){if(n&&typeof n=="object")switch(n[Re]){case He:case dt:return!0}return!1}function $(n){if(n&&typeof n=="object")switch(n[Re]){case Nn:case He:case je:case dt:return!0}return!1}var Pn=n=>(G(n)||q(n))&&!!n.anchor;var Ge=Symbol("break visit"),al=Symbol("skip children"),rt=Symbol("remove node");function at(n,e){let t=ll(e);ze(n)?bi(null,n.contents,t,Object.freeze([n]))===rt&&(n.contents=null):bi(null,n,t,Object.freeze([]))}at.BREAK=Ge;at.SKIP=al;at.REMOVE=rt;function bi(n,e,t,i){let o=cl(n,e,t,i);if($(o)||j(o))return ml(n,i,o),bi(n,o,t,i);if(typeof o!="symbol"){if(q(e)){i=Object.freeze(i.concat(e));for(let s=0;s<e.items.length;++s){let r=bi(s,e.items[s],t,i);if(typeof r=="number")s=r-1;else{if(r===Ge)return Ge;r===rt&&(e.items.splice(s,1),s-=1)}}}else if(j(e)){i=Object.freeze(i.concat(e));let s=bi("key",e.key,t,i);if(s===Ge)return Ge;s===rt&&(e.key=null);let r=bi("value",e.value,t,i);if(r===Ge)return Ge;r===rt&&(e.value=null)}}return o}function On(n,e){return W(this,null,function*(){let t=ll(e);ze(n)?(yield wi(null,n.contents,t,Object.freeze([n])))===rt&&(n.contents=null):yield wi(null,n,t,Object.freeze([]))})}On.BREAK=Ge;On.SKIP=al;On.REMOVE=rt;function wi(n,e,t,i){return W(this,null,function*(){let o=yield cl(n,e,t,i);if($(o)||j(o))return ml(n,i,o),wi(n,o,t,i);if(typeof o!="symbol"){if(q(e)){i=Object.freeze(i.concat(e));for(let s=0;s<e.items.length;++s){let r=yield wi(s,e.items[s],t,i);if(typeof r=="number")s=r-1;else{if(r===Ge)return Ge;r===rt&&(e.items.splice(s,1),s-=1)}}}else if(j(e)){i=Object.freeze(i.concat(e));let s=yield wi("key",e.key,t,i);if(s===Ge)return Ge;s===rt&&(e.key=null);let r=yield wi("value",e.value,t,i);if(r===Ge)return Ge;r===rt&&(e.value=null)}}return o})}function ll(n){return typeof n=="object"&&(n.Collection||n.Node||n.Value)?Object.assign({Alias:n.Node,Map:n.Node,Scalar:n.Node,Seq:n.Node},n.Value&&{Map:n.Value,Scalar:n.Value,Seq:n.Value},n.Collection&&{Map:n.Collection,Seq:n.Collection},n):n}function cl(n,e,t,i){if(typeof t=="function")return t(n,e,i);if(Xe(e))return t.Map?.(n,e,i);if(Je(e))return t.Seq?.(n,e,i);if(j(e))return t.Pair?.(n,e,i);if(G(e))return t.Scalar?.(n,e,i);if(We(e))return t.Alias?.(n,e,i)}function ml(n,e,t){let i=e[e.length-1];if(q(i))i.items[n]=t;else if(j(i))n==="key"?i.key=t:i.value=t;else if(ze(i))i.contents=t;else{let o=We(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${o} parent`)}}var wu={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Cu=n=>n.replace(/[!,[\]{}]/g,e=>wu[e]),Ci=(()=>{class n{constructor(t,i){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},n.defaultYaml,t),this.tags=Object.assign({},n.defaultTags,i)}clone(){let t=new n(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){let t=new n(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:n.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},n.defaultTags);break}return t}add(t,i){this.atNextDocument&&(this.yaml={explicit:n.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},n.defaultTags),this.atNextDocument=!1);let o=t.trim().split(/[ \t]+/),s=o.shift();switch(s){case"%TAG":{if(o.length!==2&&(i(0,"%TAG directive should contain exactly two parts"),o.length<2))return!1;let[r,a]=o;return this.tags[r]=a,!0}case"%YAML":{if(this.yaml.explicit=!0,o.length!==1)return i(0,"%YAML directive should contain exactly one part"),!1;let[r]=o;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{let a=/^\d+\.\d+$/.test(r);return i(6,`Unsupported YAML version ${r}`,a),!1}}default:return i(0,`Unknown directive ${s}`,!0),!1}}tagName(t,i){if(t==="!")return"!";if(t[0]!=="!")return i(`Not a valid tag: ${t}`),null;if(t[1]==="<"){let a=t.slice(2,-1);return a==="!"||a==="!!"?(i(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&i("Verbatim tags must end with a >"),a)}let[,o,s]=t.match(/^(.*!)([^!]*)$/s);s||i(`The ${t} tag has no suffix`);let r=this.tags[o];if(r)try{return r+decodeURIComponent(s)}catch(a){return i(String(a)),null}return o==="!"?t:(i(`Could not resolve tag: ${t}`),null)}tagString(t){for(let[i,o]of Object.entries(this.tags))if(t.startsWith(o))return i+Cu(t.substring(o.length));return t[0]==="!"?t:`!<${t}>`}toString(t){let i=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],o=Object.entries(this.tags),s;if(t&&o.length>0&&$(t.contents)){let r={};at(t.contents,(a,l)=>{$(l)&&l.tag&&(r[l.tag]=!0)}),s=Object.keys(r)}else s=[];for(let[r,a]of o)r==="!!"&&a==="tag:yaml.org,2002:"||(!t||s.some(l=>l.startsWith(a)))&&i.push(`%TAG ${r} ${a}`);return i.join(`
`)}}return n.defaultYaml={explicit:!1,version:"1.2"},n.defaultTags={"!!":"tag:yaml.org,2002:"},n})();function In(n){if(/[\x00-\x19\s,[\]{}]/.test(n)){let t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(n)}`;throw new Error(t)}return!0}function To(n){let e=new Set;return at(n,{Value(t,i){i.anchor&&e.add(i.anchor)}}),e}function Eo(n,e){for(let t=1;;++t){let i=`${n}${t}`;if(!e.has(i))return i}}function pl(n,e){let t=[],i=new Map,o=null;return{onAnchor:s=>{t.push(s),o??(o=To(n));let r=Eo(e,o);return o.add(r),r},setAnchors:()=>{for(let s of t){let r=i.get(s);if(typeof r=="object"&&r.anchor&&(G(r.node)||q(r.node)))r.node.anchor=r.anchor;else{let a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=s,a}}},sourceObjects:i}}function Qt(n,e,t,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let o=0,s=i.length;o<s;++o){let r=i[o],a=Qt(n,i,String(o),r);a===void 0?delete i[o]:a!==r&&(i[o]=a)}else if(i instanceof Map)for(let o of Array.from(i.keys())){let s=i.get(o),r=Qt(n,i,o,s);r===void 0?i.delete(o):r!==s&&i.set(o,r)}else if(i instanceof Set)for(let o of Array.from(i)){let s=Qt(n,i,o,o);s===void 0?i.delete(o):s!==o&&(i.delete(o),i.add(s))}else for(let[o,s]of Object.entries(i)){let r=Qt(n,i,o,s);r===void 0?delete i[o]:r!==s&&(i[o]=r)}return n.call(e,t,i)}function ie(n,e,t){if(Array.isArray(n))return n.map((i,o)=>ie(i,String(o),t));if(n&&typeof n.toJSON=="function"){if(!t||!Pn(n))return n.toJSON(e,t);let i={aliasCount:0,count:1,res:void 0};t.anchors.set(n,i),t.onCreate=s=>{i.res=s,delete t.onCreate};let o=n.toJSON(e,t);return t.onCreate&&t.onCreate(o),o}return typeof n=="bigint"&&!t?.keep?Number(n):n}var Zt=class{constructor(e){Object.defineProperty(this,Re,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:i,onAnchor:o,reviver:s}={}){if(!ze(e))throw new TypeError("A document argument is required");let r={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},a=ie(this,"",r);if(typeof o=="function")for(let{count:l,res:c}of r.anchors.values())o(c,l);return typeof s=="function"?Qt(s,{"":a},"",a):a}};var ft=class extends Zt{constructor(e){super(Nn),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,t){let i;t?.aliasResolveCache?i=t.aliasResolveCache:(i=[],at(e,{Node:(s,r)=>{(We(r)||Pn(r))&&i.push(r)}}),t&&(t.aliasResolveCache=i));let o;for(let s of i){if(s===this)break;s.anchor===this.source&&(o=s)}return o}toJSON(e,t){if(!t)return{source:this.source};let{anchors:i,doc:o,maxAliasCount:s}=t,r=this.resolve(o,t);if(!r){let l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=i.get(r);if(a||(ie(r,null,t),a=i.get(r)),!a||a.res===void 0){let l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(s>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=Ln(o,r,i)),a.count*a.aliasCount>s)){let l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,t,i){let o=`*${this.source}`;if(e){if(In(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let s=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(s)}if(e.implicitKey)return`${o} `}return o}};function Ln(n,e,t){if(We(e)){let i=e.resolve(n),o=t&&i&&t.get(i);return o?o.count*o.aliasCount:0}else if(q(e)){let i=0;for(let o of e.items){let s=Ln(n,o,t);s>i&&(i=s)}return i}else if(j(e)){let i=Ln(n,e.key,t),o=Ln(n,e.value,t);return Math.max(i,o)}return 1}var An=n=>!n||typeof n!="function"&&typeof n!="object",L=(()=>{class n extends Zt{constructor(t){super(je),this.value=t}toJSON(t,i){return i?.keep?this.value:ie(this.value,t,i)}toString(){return String(this.value)}}return n.BLOCK_FOLDED="BLOCK_FOLDED",n.BLOCK_LITERAL="BLOCK_LITERAL",n.PLAIN="PLAIN",n.QUOTE_DOUBLE="QUOTE_DOUBLE",n.QUOTE_SINGLE="QUOTE_SINGLE",n})();var Su="tag:yaml.org,2002:";function Mu(n,e,t){if(e){let i=t.filter(s=>s.tag===e),o=i.find(s=>!s.format)??i[0];if(!o)throw new Error(`Tag ${e} not found`);return o}return t.find(i=>i.identify?.(n)&&!i.format)}function ht(n,e,t){if(ze(n)&&(n=n.contents),$(n))return n;if(j(n)){let d=t.schema[He].createNode?.(t.schema,null,t);return d.items.push(n),d}(n instanceof String||n instanceof Number||n instanceof Boolean||typeof BigInt<"u"&&n instanceof BigInt)&&(n=n.valueOf());let{aliasDuplicateObjects:i,onAnchor:o,onTagObj:s,schema:r,sourceObjects:a}=t,l;if(i&&n&&typeof n=="object"){if(l=a.get(n),l)return l.anchor??(l.anchor=o(n)),new ft(l.anchor);l={anchor:null,node:null},a.set(n,l)}e?.startsWith("!!")&&(e=Su+e.slice(2));let c=Mu(n,e,r.tags);if(!c){if(n&&typeof n.toJSON=="function"&&(n=n.toJSON()),!n||typeof n!="object"){let d=new L(n);return l&&(l.node=d),d}c=n instanceof Map?r[He]:Symbol.iterator in Object(n)?r[dt]:r[He]}s&&(s(c),delete t.onTagObj);let f=c?.createNode?c.createNode(t.schema,n,t):typeof c?.nodeClass?.from=="function"?c.nodeClass.from(t.schema,n,t):new L(n);return e?f.tag=e:c.default||(f.tag=c.tag),l&&(l.node=f),f}function Di(n,e,t){let i=t;for(let o=e.length-1;o>=0;--o){let s=e[o];if(typeof s=="number"&&Number.isInteger(s)&&s>=0){let r=[];r[s]=i,i=r}else i=new Map([[s,i]])}return ht(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:n,sourceObjects:new Map})}var Mi=n=>n==null||typeof n=="object"&&!!n[Symbol.iterator]().next().done,Si=class extends Zt{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(i=>$(i)||j(i)?i.clone(e):i),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(Mi(e))this.add(t);else{let[i,...o]=e,s=this.get(i,!0);if(q(s))s.addIn(o,t);else if(s===void 0&&this.schema)this.set(i,Di(this.schema,o,t));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${o}`)}}deleteIn(e){let[t,...i]=e;if(i.length===0)return this.delete(t);let o=this.get(t,!0);if(q(o))return o.deleteIn(i);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${i}`)}getIn(e,t){let[i,...o]=e,s=this.get(i,!0);return o.length===0?!t&&G(s)?s.value:s:q(s)?s.getIn(o,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!j(t))return!1;let i=t.value;return i==null||e&&G(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(e){let[t,...i]=e;if(i.length===0)return this.has(t);let o=this.get(t,!0);return q(o)?o.hasIn(i):!1}setIn(e,t){let[i,...o]=e;if(o.length===0)this.set(i,t);else{let s=this.get(i,!0);if(q(s))s.setIn(o,t);else if(s===void 0&&this.schema)this.set(i,Di(this.schema,o,t));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${o}`)}}};var ul=n=>n.replace(/^(?!$)(?: $)?/gm,"#");function Ke(n,e){return/^\n+$/.test(n)?n.substring(1):e?n.replace(/^(?! *$)/gm,e):n}var lt=(n,e,t)=>n.endsWith(`
`)?Ke(t,e):t.includes(`
`)?`
`+Ke(t,e):(n.endsWith(" ")?"":" ")+t;var No="flow",Dn="block",Fi="quoted";function Ri(n,e,t="flow",{indentAtStart:i,lineWidth:o=80,minContentWidth:s=20,onFold:r,onOverflow:a}={}){if(!o||o<0)return n;o<s&&(s=0);let l=Math.max(1+s,1+o-e.length);if(n.length<=l)return n;let c=[],f={},d=o-e.length;typeof i=="number"&&(i>o-Math.max(2,s)?c.push(0):d=o-i);let u,y,x=!1,h=-1,_=-1,E=-1;t===Dn&&(h=dl(n,h,e.length),h!==-1&&(d=h+l));for(let D;D=n[h+=1];){if(t===Fi&&D==="\\"){switch(_=h,n[h+1]){case"x":h+=3;break;case"u":h+=5;break;case"U":h+=9;break;default:h+=1}E=h}if(D===`
`)t===Dn&&(h=dl(n,h,e.length)),d=h+e.length+l,u=void 0;else{if(D===" "&&y&&y!==" "&&y!==`
`&&y!=="	"){let R=n[h+1];R&&R!==" "&&R!==`
`&&R!=="	"&&(u=h)}if(h>=d)if(u)c.push(u),d=u+l,u=void 0;else if(t===Fi){for(;y===" "||y==="	";)y=D,D=n[h+=1],x=!0;let R=h>E+1?h-2:_-1;if(f[R])return n;c.push(R),f[R]=!0,d=R+l,u=void 0}else x=!0}y=D}if(x&&a&&a(),c.length===0)return n;r&&r();let N=n.slice(0,c[0]);for(let D=0;D<c.length;++D){let R=c[D],V=c[D+1]||n.length;R===0?N=`
${e}${n.slice(0,V)}`:(t===Fi&&f[R]&&(N+=`${n[R]}\\`),N+=`
${e}${n.slice(R+1,V)}`)}return N}function dl(n,e,t){let i=e,o=e+1,s=n[o];for(;s===" "||s==="	";)if(e<o+t)s=n[++e];else{do s=n[++e];while(s&&s!==`
`);i=e,o=e+1,s=n[o]}return i}var Rn=(n,e)=>({indentAtStart:e?n.indent.length:n.indentAtStart,lineWidth:n.options.lineWidth,minContentWidth:n.options.minContentWidth}),Vn=n=>/^(%|---|\.\.\.)/m.test(n);function vu(n,e,t){if(!e||e<0)return!1;let i=e-t,o=n.length;if(o<=i)return!1;for(let s=0,r=0;s<o;++s)if(n[s]===`
`){if(s-r>i)return!0;if(r=s+1,o-r<=i)return!1}return!0}function Vi(n,e){let t=JSON.stringify(n);if(e.options.doubleQuotedAsJSON)return t;let{implicitKey:i}=e,o=e.options.doubleQuotedMinMultiLineLength,s=e.indent||(Vn(n)?"  ":""),r="",a=0;for(let l=0,c=t[l];c;c=t[++l])if(c===" "&&t[l+1]==="\\"&&t[l+2]==="n"&&(r+=t.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),c==="\\")switch(t[l+1]){case"u":{r+=t.slice(a,l);let f=t.substr(l+2,4);switch(f){case"0000":r+="\\0";break;case"0007":r+="\\a";break;case"000b":r+="\\v";break;case"001b":r+="\\e";break;case"0085":r+="\\N";break;case"00a0":r+="\\_";break;case"2028":r+="\\L";break;case"2029":r+="\\P";break;default:f.substr(0,2)==="00"?r+="\\x"+f.substr(2):r+=t.substr(l,6)}l+=5,a=l+1}break;case"n":if(i||t[l+2]==='"'||t.length<o)l+=1;else{for(r+=t.slice(a,l)+`

`;t[l+2]==="\\"&&t[l+3]==="n"&&t[l+4]!=='"';)r+=`
`,l+=2;r+=s,t[l+2]===" "&&(r+="\\"),l+=1,a=l+1}break;default:l+=1}return r=a?r+t.slice(a):t,i?r:Ri(r,s,Fi,Rn(e,!1))}function ko(n,e){if(e.options.singleQuote===!1||e.implicitKey&&n.includes(`
`)||/[ \t]\n|\n[ \t]/.test(n))return Vi(n,e);let t=e.indent||(Vn(n)?"  ":""),i="'"+n.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?i:Ri(i,t,No,Rn(e,!1))}function vi(n,e){let{singleQuote:t}=e.options,i;if(t===!1)i=Vi;else{let o=n.includes('"'),s=n.includes("'");o&&!s?i=ko:s&&!o?i=Vi:i=t?ko:Vi}return i(n,e)}var Po;try{Po=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Po=/\n+(?!\n|$)/g}function Fn({comment:n,type:e,value:t},i,o,s){let{blockQuote:r,commentString:a,lineWidth:l}=i.options;if(!r||/\n[\t ]+$/.test(t))return vi(t,i);let c=i.indent||(i.forceBlockIndent||Vn(t)?"  ":""),f=r==="literal"?!0:r==="folded"||e===L.BLOCK_FOLDED?!1:e===L.BLOCK_LITERAL?!0:!vu(t,l,c.length);if(!t)return f?`|
`:`>
`;let d,u;for(u=t.length;u>0;--u){let V=t[u-1];if(V!==`
`&&V!=="	"&&V!==" ")break}let y=t.substring(u),x=y.indexOf(`
`);x===-1?d="-":t===y||x!==y.length-1?(d="+",s&&s()):d="",y&&(t=t.slice(0,-y.length),y[y.length-1]===`
`&&(y=y.slice(0,-1)),y=y.replace(Po,`$&${c}`));let h=!1,_,E=-1;for(_=0;_<t.length;++_){let V=t[_];if(V===" ")h=!0;else if(V===`
`)E=_;else break}let N=t.substring(0,E<_?E+1:_);N&&(t=t.substring(N.length),N=N.replace(/\n+/g,`$&${c}`));let R=(h?c?"2":"1":"")+d;if(n&&(R+=" "+a(n.replace(/ ?[\r\n]+/g," ")),o&&o()),!f){let V=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`),B=!1,U=Rn(i,!0);r!=="folded"&&e!==L.BLOCK_FOLDED&&(U.onOverflow=()=>{B=!0});let k=Ri(`${N}${V}${y}`,c,Dn,U);if(!B)return`>${R}
${c}${k}`}return t=t.replace(/\n+/g,`$&${c}`),`|${R}
${c}${N}${t}${y}`}function xu(n,e,t,i){let{type:o,value:s}=n,{actualString:r,implicitKey:a,indent:l,indentStep:c,inFlow:f}=e;if(a&&s.includes(`
`)||f&&/[[\]{},]/.test(s))return vi(s,e);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return a||f||!s.includes(`
`)?vi(s,e):Fn(n,e,t,i);if(!a&&!f&&o!==L.PLAIN&&s.includes(`
`))return Fn(n,e,t,i);if(Vn(s)){if(l==="")return e.forceBlockIndent=!0,Fn(n,e,t,i);if(a&&l===c)return vi(s,e)}let d=s.replace(/\n+/g,`$&
${l}`);if(r){let u=h=>h.default&&h.tag!=="tag:yaml.org,2002:str"&&h.test?.test(d),{compat:y,tags:x}=e.doc.schema;if(x.some(u)||y?.some(u))return vi(s,e)}return a?d:Ri(d,l,No,Rn(e,!1))}function li(n,e,t,i){let{implicitKey:o,inFlow:s}=e,r=typeof n.value=="string"?n:Object.assign({},n,{value:String(n.value)}),{type:a}=n;a!==L.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(r.value)&&(a=L.QUOTE_DOUBLE);let l=f=>{switch(f){case L.BLOCK_FOLDED:case L.BLOCK_LITERAL:return o||s?vi(r.value,e):Fn(r,e,t,i);case L.QUOTE_DOUBLE:return Vi(r.value,e);case L.QUOTE_SINGLE:return ko(r.value,e);case L.PLAIN:return xu(r,e,t,i);default:return null}},c=l(a);if(c===null){let{defaultKeyType:f,defaultStringType:d}=e.options,u=o&&f||d;if(c=l(u),c===null)throw new Error(`Unsupported default string type ${u}`)}return c}function Bn(n,e){let t=Object.assign({blockQuote:!0,commentString:ul,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},n.schema.toStringOptions,e),i;switch(t.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:n,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:i,options:t}}function Tu(n,e){if(e.tag){let o=n.filter(s=>s.tag===e.tag);if(o.length>0)return o.find(s=>s.format===e.format)??o[0]}let t,i;if(G(e)){i=e.value;let o=n.filter(s=>s.identify?.(i));if(o.length>1){let s=o.filter(r=>r.test);s.length>0&&(o=s)}t=o.find(s=>s.format===e.format)??o.find(s=>!s.format)}else i=e,t=n.find(o=>o.nodeClass&&i instanceof o.nodeClass);if(!t){let o=i?.constructor?.name??(i===null?"null":typeof i);throw new Error(`Tag not resolved for ${o} value`)}return t}function Eu(n,e,{anchors:t,doc:i}){if(!i.directives)return"";let o=[],s=(G(n)||q(n))&&n.anchor;s&&In(s)&&(t.add(s),o.push(`&${s}`));let r=n.tag??(e.default?null:e.tag);return r&&o.push(i.directives.tagString(r)),o.join(" ")}function gt(n,e,t,i){if(j(n))return n.toString(e,t,i);if(We(n)){if(e.doc.directives)return n.toString(e);if(e.resolvedAliases?.has(n))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(n):e.resolvedAliases=new Set([n]),n=n.resolve(e.doc)}let o,s=$(n)?n:e.doc.createNode(n,{onTagObj:l=>o=l});o??(o=Tu(e.doc.schema.tags,s));let r=Eu(s,o,e);r.length>0&&(e.indentAtStart=(e.indentAtStart??0)+r.length+1);let a=typeof o.stringify=="function"?o.stringify(s,e,t,i):G(s)?li(s,e,t,i):s.toString(e,t,i);return r?G(s)||a[0]==="{"||a[0]==="["?`${r} ${a}`:`${r}
${e.indent}${a}`:a}function fl({key:n,value:e},t,i,o){let{allNullValues:s,doc:r,indent:a,indentStep:l,options:{commentString:c,indentSeq:f,simpleKeys:d}}=t,u=$(n)&&n.comment||null;if(d){if(u)throw new Error("With simple keys, key nodes cannot have comments");if(q(n)||!$(n)&&typeof n=="object"){let U="With simple keys, collection cannot be used as a key value";throw new Error(U)}}let y=!d&&(!n||u&&e==null&&!t.inFlow||q(n)||(G(n)?n.type===L.BLOCK_FOLDED||n.type===L.BLOCK_LITERAL:typeof n=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!y&&(d||!s),indent:a+l});let x=!1,h=!1,_=gt(n,t,()=>x=!0,()=>h=!0);if(!y&&!t.inFlow&&_.length>1024){if(d)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");y=!0}if(t.inFlow){if(s||e==null)return x&&i&&i(),_===""?"?":y?`? ${_}`:_}else if(s&&!d||e==null&&y)return _=`? ${_}`,u&&!x?_+=lt(_,t.indent,c(u)):h&&o&&o(),_;x&&(u=null),y?(u&&(_+=lt(_,t.indent,c(u))),_=`? ${_}
${a}:`):(_=`${_}:`,u&&(_+=lt(_,t.indent,c(u))));let E,N,D;$(e)?(E=!!e.spaceBefore,N=e.commentBefore,D=e.comment):(E=!1,N=null,D=null,e&&typeof e=="object"&&(e=r.createNode(e))),t.implicitKey=!1,!y&&!u&&G(e)&&(t.indentAtStart=_.length+1),h=!1,!f&&l.length>=2&&!t.inFlow&&!y&&Je(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let R=!1,V=gt(e,t,()=>R=!0,()=>h=!0),B=" ";if(u||E||N){if(B=E?`
`:"",N){let U=c(N);B+=`
${Ke(U,t.indent)}`}V===""&&!t.inFlow?B===`
`&&(B=`

`):B+=`
${t.indent}`}else if(!y&&q(e)){let U=V[0],k=V.indexOf(`
`),Q=k!==-1,_t=t.inFlow??e.flow??e.items.length===0;if(Q||!_t){let pi=!1;if(Q&&(U==="&"||U==="!")){let Z=V.indexOf(" ");U==="&"&&Z!==-1&&Z<k&&V[Z+1]==="!"&&(Z=V.indexOf(" ",Z+1)),(Z===-1||k<Z)&&(pi=!0)}pi||(B=`
${t.indent}`)}}else(V===""||V[0]===`
`)&&(B="");return _+=B+V,t.inFlow?R&&i&&i():D&&!R?_+=lt(_,t.indent,c(D)):h&&o&&o(),_}function Gn(n,e){(n==="debug"||n==="warn")&&console.warn(e)}var jn="<<",Qe={identify:n=>n===jn||typeof n=="symbol"&&n.description===jn,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new L(Symbol(jn)),{addToJSMap:Io}),stringify:()=>jn},hl=(n,e)=>(Qe.identify(e)||G(e)&&(!e.type||e.type===L.PLAIN)&&Qe.identify(e.value))&&n?.doc.schema.tags.some(t=>t.tag===Qe.tag&&t.default);function Io(n,e,t){if(t=n&&We(t)?t.resolve(n.doc):t,Je(t))for(let i of t.items)Oo(n,e,i);else if(Array.isArray(t))for(let i of t)Oo(n,e,i);else Oo(n,e,t)}function Oo(n,e,t){let i=n&&We(t)?t.resolve(n.doc):t;if(!Xe(i))throw new Error("Merge sources must be maps or map aliases");let o=i.toJSON(null,n,Map);for(let[s,r]of o)e instanceof Map?e.has(s)||e.set(s,r):e instanceof Set?e.add(s):Object.prototype.hasOwnProperty.call(e,s)||Object.defineProperty(e,s,{value:r,writable:!0,enumerable:!0,configurable:!0});return e}function $n(n,e,{key:t,value:i}){if($(t)&&t.addToJSMap)t.addToJSMap(n,e,i);else if(hl(n,t))Io(n,e,i);else{let o=ie(t,"",n);if(e instanceof Map)e.set(o,ie(i,o,n));else if(e instanceof Set)e.add(o);else{let s=Nu(t,o,n),r=ie(i,s,n);s in e?Object.defineProperty(e,s,{value:r,writable:!0,enumerable:!0,configurable:!0}):e[s]=r}}return e}function Nu(n,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if($(n)&&t?.doc){let i=Bn(t.doc,{});i.anchors=new Set;for(let s of t.anchors.keys())i.anchors.add(s.anchor);i.inFlow=!0,i.inStringifyKey=!0;let o=n.toString(i);if(!t.mapKeyWarned){let s=JSON.stringify(o);s.length>40&&(s=s.substring(0,36)+'..."'),Gn(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${s}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return o}return JSON.stringify(e)}function xi(n,e,t){let i=ht(n,void 0,t),o=ht(e,void 0,t);return new H(i,o)}var H=class n{constructor(e,t=null){Object.defineProperty(this,Re,{value:xo}),this.key=e,this.value=t}clone(e){let{key:t,value:i}=this;return $(t)&&(t=t.clone(e)),$(i)&&(i=i.clone(e)),new n(t,i)}toJSON(e,t){let i=t?.mapAsMap?new Map:{};return $n(t,i,this)}toString(e,t,i){return e?.doc?fl(this,e,t,i):JSON.stringify(this)}};function Wn(n,e,t){return(e.inFlow??n.flow?Pu:ku)(n,e,t)}function ku({comment:n,items:e},t,{blockItemPrefix:i,flowChars:o,itemIndent:s,onChompKeep:r,onComment:a}){let{indent:l,options:{commentString:c}}=t,f=Object.assign({},t,{indent:s,type:null}),d=!1,u=[];for(let x=0;x<e.length;++x){let h=e[x],_=null;if($(h))!d&&h.spaceBefore&&u.push(""),qn(t,u,h.commentBefore,d),h.comment&&(_=h.comment);else if(j(h)){let N=$(h.key)?h.key:null;N&&(!d&&N.spaceBefore&&u.push(""),qn(t,u,N.commentBefore,d))}d=!1;let E=gt(h,f,()=>_=null,()=>d=!0);_&&(E+=lt(E,s,c(_))),d&&_&&(d=!1),u.push(i+E)}let y;if(u.length===0)y=o.start+o.end;else{y=u[0];for(let x=1;x<u.length;++x){let h=u[x];y+=h?`
${l}${h}`:`
`}}return n?(y+=`
`+Ke(c(n),l),a&&a()):d&&r&&r(),y}function Pu({items:n},e,{flowChars:t,itemIndent:i}){let{indent:o,indentStep:s,flowCollectionPadding:r,options:{commentString:a}}=e;i+=s;let l=Object.assign({},e,{indent:i,inFlow:!0,type:null}),c=!1,f=0,d=[];for(let x=0;x<n.length;++x){let h=n[x],_=null;if($(h))h.spaceBefore&&d.push(""),qn(e,d,h.commentBefore,!1),h.comment&&(_=h.comment);else if(j(h)){let N=$(h.key)?h.key:null;N&&(N.spaceBefore&&d.push(""),qn(e,d,N.commentBefore,!1),N.comment&&(c=!0));let D=$(h.value)?h.value:null;D?(D.comment&&(_=D.comment),D.commentBefore&&(c=!0)):h.value==null&&N?.comment&&(_=N.comment)}_&&(c=!0);let E=gt(h,l,()=>_=null);x<n.length-1&&(E+=","),_&&(E+=lt(E,i,a(_))),!c&&(d.length>f||E.includes(`
`))&&(c=!0),d.push(E),f=d.length}let{start:u,end:y}=t;if(d.length===0)return u+y;if(!c){let x=d.reduce((h,_)=>h+_.length+2,2);c=e.options.lineWidth>0&&x>e.options.lineWidth}if(c){let x=u;for(let h of d)x+=h?`
${s}${o}${h}`:`
`;return`${x}
${o}${y}`}else return`${u}${r}${d.join(" ")}${r}${y}`}function qn({indent:n,options:{commentString:e}},t,i,o){if(i&&o&&(i=i.replace(/^\n+/,"")),i){let s=Ke(e(i),n);t.push(s.trimStart())}}function ei(n,e){let t=G(e)?e.value:e;for(let i of n)if(j(i)&&(i.key===e||i.key===t||G(i.key)&&i.key.value===t))return i}var J=class extends Si{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(He,e),this.items=[]}static from(e,t,i){let{keepUndefined:o,replacer:s}=i,r=new this(e),a=(l,c)=>{if(typeof s=="function")c=s.call(t,l,c);else if(Array.isArray(s)&&!s.includes(l))return;(c!==void 0||o)&&r.items.push(xi(l,c,i))};if(t instanceof Map)for(let[l,c]of t)a(l,c);else if(t&&typeof t=="object")for(let l of Object.keys(t))a(l,t[l]);return typeof e.sortMapEntries=="function"&&r.items.sort(e.sortMapEntries),r}add(e,t){let i;j(e)?i=e:!e||typeof e!="object"||!("key"in e)?i=new H(e,e?.value):i=new H(e.key,e.value);let o=ei(this.items,i.key),s=this.schema?.sortMapEntries;if(o){if(!t)throw new Error(`Key ${i.key} already set`);G(o.value)&&An(i.value)?o.value.value=i.value:o.value=i.value}else if(s){let r=this.items.findIndex(a=>s(i,a)<0);r===-1?this.items.push(i):this.items.splice(r,0,i)}else this.items.push(i)}delete(e){let t=ei(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){let o=ei(this.items,e)?.value;return(!t&&G(o)?o.value:o)??void 0}has(e){return!!ei(this.items,e)}set(e,t){this.add(new H(e,t),!0)}toJSON(e,t,i){let o=i?new i:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(o);for(let s of this.items)$n(t,o,s);return o}toString(e,t,i){if(!e)return JSON.stringify(this);for(let o of this.items)if(!j(o))throw new Error(`Map items must all be pairs; found ${JSON.stringify(o)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Wn(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:i,onComment:t})}};var Ze={collection:"map",default:!0,nodeClass:J,tag:"tag:yaml.org,2002:map",resolve(n,e){return Xe(n)||e("Expected a mapping for this tag"),n},createNode:(n,e,t)=>J.from(n,e,t)};var Ie=class extends Si{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(dt,e),this.items=[]}add(e){this.items.push(e)}delete(e){let t=Kn(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){let i=Kn(e);if(typeof i!="number")return;let o=this.items[i];return!t&&G(o)?o.value:o}has(e){let t=Kn(e);return typeof t=="number"&&t<this.items.length}set(e,t){let i=Kn(e);if(typeof i!="number")throw new Error(`Expected a valid index, not ${e}.`);let o=this.items[i];G(o)&&An(t)?o.value=t:this.items[i]=t}toJSON(e,t){let i=[];t?.onCreate&&t.onCreate(i);let o=0;for(let s of this.items)i.push(ie(s,String(o++),t));return i}toString(e,t,i){return e?Wn(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:i,onComment:t}):JSON.stringify(this)}static from(e,t,i){let{replacer:o}=i,s=new this(e);if(t&&Symbol.iterator in Object(t)){let r=0;for(let a of t){if(typeof o=="function"){let l=t instanceof Set?a:String(r++);a=o.call(t,l,a)}s.items.push(ht(a,void 0,i))}}return s}};function Kn(n){let e=G(n)?n.value:n;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}var et={collection:"seq",default:!0,nodeClass:Ie,tag:"tag:yaml.org,2002:seq",resolve(n,e){return Je(n)||e("Expected a sequence for this tag"),n},createNode:(n,e,t)=>Ie.from(n,e,t)};var ti={identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify(n,e,t,i){return e=Object.assign({actualString:!0},e),li(n,e,t,i)}};var ci={identify:n=>n==null,createNode:()=>new L(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new L(null),stringify:({source:n},e)=>typeof n=="string"&&ci.test.test(n)?n:e.options.nullStr};var Bi={identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:n=>new L(n[0]==="t"||n[0]==="T"),stringify({source:n,value:e},t){if(n&&Bi.test.test(n)){let i=n[0]==="t"||n[0]==="T";if(e===i)return n}return e?t.options.trueStr:t.options.falseStr}};function Le({format:n,minFractionDigits:e,tag:t,value:i}){if(typeof i=="bigint")return String(i);let o=typeof i=="number"?i:Number(i);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let s=JSON.stringify(i);if(!n&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(s)){let r=s.indexOf(".");r<0&&(r=s.length,s+=".");let a=e-(s.length-r-1);for(;a-- >0;)s+="0"}return s}var Un={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Le},Yn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n),stringify(n){let e=Number(n.value);return isFinite(e)?e.toExponential():Le(n)}},Hn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(n){let e=new L(parseFloat(n)),t=n.indexOf(".");return t!==-1&&n[n.length-1]==="0"&&(e.minFractionDigits=n.length-t-1),e},stringify:Le};var zn=n=>typeof n=="bigint"||Number.isInteger(n),Lo=(n,e,t,{intAsBigInt:i})=>i?BigInt(n):parseInt(n.substring(e),t);function gl(n,e,t){let{value:i}=n;return zn(i)&&i>=0?t+i.toString(e):Le(n)}var Xn={identify:n=>zn(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(n,e,t)=>Lo(n,2,8,t),stringify:n=>gl(n,8,"0o")},Jn={identify:zn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(n,e,t)=>Lo(n,0,10,t),stringify:Le},Qn={identify:n=>zn(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(n,e,t)=>Lo(n,2,16,t),stringify:n=>gl(n,16,"0x")};var yl=[Ze,et,ti,ci,Bi,Xn,Jn,Qn,Un,Yn,Hn];function _l(n){return typeof n=="bigint"||Number.isInteger(n)}var Zn=({value:n})=>JSON.stringify(n),Ou=[{identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify:Zn},{identify:n=>n==null,createNode:()=>new L(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Zn},{identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:n=>n==="true",stringify:Zn},{identify:_l,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(n,e,{intAsBigInt:t})=>t?BigInt(n):parseInt(n,10),stringify:({value:n})=>_l(n)?n.toString():JSON.stringify(n)},{identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:n=>parseFloat(n),stringify:Zn}],Iu={default:!0,tag:"",test:/^/,resolve(n,e){return e(`Unresolved plain scalar ${JSON.stringify(n)}`),n}},bl=[Ze,et].concat(Ou,Iu);var Gi={identify:n=>n instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(n,e){if(typeof atob=="function"){let t=atob(n.replace(/[\n\r]/g,"")),i=new Uint8Array(t.length);for(let o=0;o<t.length;++o)i[o]=t.charCodeAt(o);return i}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),n},stringify({comment:n,type:e,value:t},i,o,s){if(!t)return"";let r=t,a;if(typeof btoa=="function"){let l="";for(let c=0;c<r.length;++c)l+=String.fromCharCode(r[c]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e??(e=L.BLOCK_LITERAL),e!==L.QUOTE_DOUBLE){let l=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),c=Math.ceil(a.length/l),f=new Array(c);for(let d=0,u=0;d<c;++d,u+=l)f[d]=a.substr(u,l);a=f.join(e===L.BLOCK_LITERAL?`
`:" ")}return li({comment:n,type:e,value:a},i,o,s)}};function Ao(n,e){if(Je(n))for(let t=0;t<n.items.length;++t){let i=n.items[t];if(!j(i)){if(Xe(i)){i.items.length>1&&e("Each pair must have its own sequence indicator");let o=i.items[0]||new H(new L(null));if(i.commentBefore&&(o.key.commentBefore=o.key.commentBefore?`${i.commentBefore}
${o.key.commentBefore}`:i.commentBefore),i.comment){let s=o.value??o.key;s.comment=s.comment?`${i.comment}
${s.comment}`:i.comment}i=o}n.items[t]=j(i)?i:new H(i)}}else e("Expected a sequence for this tag");return n}function Do(n,e,t){let{replacer:i}=t,o=new Ie(n);o.tag="tag:yaml.org,2002:pairs";let s=0;if(e&&Symbol.iterator in Object(e))for(let r of e){typeof i=="function"&&(r=i.call(e,String(s++),r));let a,l;if(Array.isArray(r))if(r.length===2)a=r[0],l=r[1];else throw new TypeError(`Expected [key, value] tuple: ${r}`);else if(r&&r instanceof Object){let c=Object.keys(r);if(c.length===1)a=c[0],l=r[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=r;o.items.push(xi(a,l,t))}return o}var ji={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Ao,createNode:Do};var Fo=(()=>{class n extends Ie{constructor(){super(),this.add=J.prototype.add.bind(this),this.delete=J.prototype.delete.bind(this),this.get=J.prototype.get.bind(this),this.has=J.prototype.has.bind(this),this.set=J.prototype.set.bind(this),this.tag=n.tag}toJSON(t,i){if(!i)return super.toJSON(t);let o=new Map;i?.onCreate&&i.onCreate(o);for(let s of this.items){let r,a;if(j(s)?(r=ie(s.key,"",i),a=ie(s.value,r,i)):r=ie(s,"",i),o.has(r))throw new Error("Ordered maps must not include duplicate keys");o.set(r,a)}return o}static from(t,i,o){let s=Do(t,i,o),r=new this;return r.items=s.items,r}}return n.tag="tag:yaml.org,2002:omap",n})(),$i={collection:"seq",identify:n=>n instanceof Map,nodeClass:Fo,default:!1,tag:"tag:yaml.org,2002:omap",resolve(n,e){let t=Ao(n,e),i=[];for(let{key:o}of t.items)G(o)&&(i.includes(o.value)?e(`Ordered maps must not include duplicate keys: ${o.value}`):i.push(o.value));return Object.assign(new Fo,t)},createNode:(n,e,t)=>Fo.from(n,e,t)};function wl({value:n,source:e},t){return e&&(n?Ro:Vo).test.test(e)?e:n?t.options.trueStr:t.options.falseStr}var Ro={identify:n=>n===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new L(!0),stringify:wl},Vo={identify:n=>n===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new L(!1),stringify:wl};var Cl={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Le},Sl={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n.replace(/_/g,"")),stringify(n){let e=Number(n.value);return isFinite(e)?e.toExponential():Le(n)}},Ml={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(n){let e=new L(parseFloat(n.replace(/_/g,""))),t=n.indexOf(".");if(t!==-1){let i=n.substring(t+1).replace(/_/g,"");i[i.length-1]==="0"&&(e.minFractionDigits=i.length)}return e},stringify:Le};var qi=n=>typeof n=="bigint"||Number.isInteger(n);function eo(n,e,t,{intAsBigInt:i}){let o=n[0];if((o==="-"||o==="+")&&(e+=1),n=n.substring(e).replace(/_/g,""),i){switch(t){case 2:n=`0b${n}`;break;case 8:n=`0o${n}`;break;case 16:n=`0x${n}`;break}let r=BigInt(n);return o==="-"?BigInt(-1)*r:r}let s=parseInt(n,t);return o==="-"?-1*s:s}function Bo(n,e,t){let{value:i}=n;if(qi(i)){let o=i.toString(e);return i<0?"-"+t+o.substr(1):t+o}return Le(n)}var vl={identify:qi,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(n,e,t)=>eo(n,2,2,t),stringify:n=>Bo(n,2,"0b")},xl={identify:qi,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(n,e,t)=>eo(n,1,8,t),stringify:n=>Bo(n,8,"0")},Tl={identify:qi,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(n,e,t)=>eo(n,0,10,t),stringify:Le},El={identify:qi,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(n,e,t)=>eo(n,2,16,t),stringify:n=>Bo(n,16,"0x")};var Go=(()=>{class n extends J{constructor(t){super(t),this.tag=n.tag}add(t){let i;j(t)?i=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?i=new H(t.key,null):i=new H(t,null),ei(this.items,i.key)||this.items.push(i)}get(t,i){let o=ei(this.items,t);return!i&&j(o)?G(o.key)?o.key.value:o.key:o}set(t,i){if(typeof i!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof i}`);let o=ei(this.items,t);o&&!i?this.items.splice(this.items.indexOf(o),1):!o&&i&&this.items.push(new H(t))}toJSON(t,i){return super.toJSON(t,i,Set)}toString(t,i,o){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),i,o);throw new Error("Set items must all have null values")}static from(t,i,o){let{replacer:s}=o,r=new this(t);if(i&&Symbol.iterator in Object(i))for(let a of i)typeof s=="function"&&(a=s.call(i,a,a)),r.items.push(xi(a,null,o));return r}}return n.tag="tag:yaml.org,2002:set",n})(),Wi={collection:"map",identify:n=>n instanceof Set,nodeClass:Go,default:!1,tag:"tag:yaml.org,2002:set",createNode:(n,e,t)=>Go.from(n,e,t),resolve(n,e){if(Xe(n)){if(n.hasAllNullValues(!0))return Object.assign(new Go,n);e("Set items must all have null values")}else e("Expected a mapping for this tag");return n}};function jo(n,e){let t=n[0],i=t==="-"||t==="+"?n.substring(1):n,o=r=>e?BigInt(r):Number(r),s=i.replace(/_/g,"").split(":").reduce((r,a)=>r*o(60)+o(a),o(0));return t==="-"?o(-1)*s:s}function Nl(n){let{value:e}=n,t=r=>r;if(typeof e=="bigint")t=r=>BigInt(r);else if(isNaN(e)||!isFinite(e))return Le(n);let i="";e<0&&(i="-",e*=t(-1));let o=t(60),s=[e%o];return e<60?s.unshift(0):(e=(e-s[0])/o,s.unshift(e%o),e>=60&&(e=(e-s[0])/o,s.unshift(e))),i+s.map(r=>String(r).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var to={identify:n=>typeof n=="bigint"||Number.isInteger(n),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(n,e,{intAsBigInt:t})=>jo(n,t),stringify:Nl},io={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:n=>jo(n,!1),stringify:Nl},Ti={identify:n=>n instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(n){let e=n.match(Ti.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,t,i,o,s,r,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0,c=Date.UTC(t,i-1,o,s||0,r||0,a||0,l),f=e[8];if(f&&f!=="Z"){let d=jo(f,!1);Math.abs(d)<30&&(d*=60),c-=6e4*d}return new Date(c)},stringify:({value:n})=>n?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""};var $o=[Ze,et,ti,ci,Ro,Vo,vl,xl,Tl,El,Cl,Sl,Ml,Gi,Qe,$i,ji,Wi,to,io,Ti];var kl=new Map([["core",yl],["failsafe",[Ze,et,ti]],["json",bl],["yaml11",$o],["yaml-1.1",$o]]),Pl={binary:Gi,bool:Bi,float:Hn,floatExp:Yn,floatNaN:Un,floatTime:io,int:Jn,intHex:Qn,intOct:Xn,intTime:to,map:Ze,merge:Qe,null:ci,omap:$i,pairs:ji,seq:et,set:Wi,timestamp:Ti},Ol={"tag:yaml.org,2002:binary":Gi,"tag:yaml.org,2002:merge":Qe,"tag:yaml.org,2002:omap":$i,"tag:yaml.org,2002:pairs":ji,"tag:yaml.org,2002:set":Wi,"tag:yaml.org,2002:timestamp":Ti};function no(n,e,t){let i=kl.get(e);if(i&&!n)return t&&!i.includes(Qe)?i.concat(Qe):i.slice();let o=i;if(!o)if(Array.isArray(n))o=[];else{let s=Array.from(kl.keys()).filter(r=>r!=="yaml11").map(r=>JSON.stringify(r)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${s} or define customTags array`)}if(Array.isArray(n))for(let s of n)o=o.concat(s);else typeof n=="function"&&(o=n(o.slice()));return t&&(o=o.concat(Qe)),o.reduce((s,r)=>{let a=typeof r=="string"?Pl[r]:r;if(!a){let l=JSON.stringify(r),c=Object.keys(Pl).map(f=>JSON.stringify(f)).join(", ");throw new Error(`Unknown custom tag ${l}; use one of ${c}`)}return s.includes(a)||s.push(a),s},[])}var Lu=(n,e)=>n.key<e.key?-1:n.key>e.key?1:0,Ki=class n{constructor({compat:e,customTags:t,merge:i,resolveKnownTags:o,schema:s,sortMapEntries:r,toStringDefaults:a}){this.compat=Array.isArray(e)?no(e,"compat"):e?no(null,e):null,this.name=typeof s=="string"&&s||"core",this.knownTags=o?Ol:{},this.tags=no(t,this.name,i),this.toStringOptions=a??null,Object.defineProperty(this,He,{value:Ze}),Object.defineProperty(this,je,{value:ti}),Object.defineProperty(this,dt,{value:et}),this.sortMapEntries=typeof r=="function"?r:r===!0?Lu:null}clone(){let e=Object.create(n.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};function Il(n,e){let t=[],i=e.directives===!0;if(e.directives!==!1&&n.directives){let l=n.directives.toString(n);l?(t.push(l),i=!0):n.directives.docStart&&(i=!0)}i&&t.push("---");let o=Bn(n,e),{commentString:s}=o.options;if(n.commentBefore){t.length!==1&&t.unshift("");let l=s(n.commentBefore);t.unshift(Ke(l,""))}let r=!1,a=null;if(n.contents){if($(n.contents)){if(n.contents.spaceBefore&&i&&t.push(""),n.contents.commentBefore){let f=s(n.contents.commentBefore);t.push(Ke(f,""))}o.forceBlockIndent=!!n.comment,a=n.contents.comment}let l=a?void 0:()=>r=!0,c=gt(n.contents,o,()=>a=null,l);a&&(c+=lt(c,"",s(a))),(c[0]==="|"||c[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${c}`:t.push(c)}else t.push(gt(n.contents,o));if(n.directives?.docEnd)if(n.comment){let l=s(n.comment);l.includes(`
`)?(t.push("..."),t.push(Ke(l,""))):t.push(`... ${l}`)}else t.push("...");else{let l=n.comment;l&&r&&(l=l.replace(/^\n+/,"")),l&&((!r||a)&&t[t.length-1]!==""&&t.push(""),t.push(Ke(s(l),"")))}return t.join(`
`)+`
`}var yt=class n{constructor(e,t,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Re,{value:kn});let o=null;typeof t=="function"||Array.isArray(t)?o=t:i===void 0&&t&&(i=t,t=void 0);let s=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},i);this.options=s;let{version:r}=s;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(r=this.directives.yaml.version)):this.directives=new Ci({version:r}),this.setSchema(r,i),this.contents=e===void 0?null:this.createNode(e,o,i)}clone(){let e=Object.create(n.prototype,{[Re]:{value:kn}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=$(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Ei(this.contents)&&this.contents.add(e)}addIn(e,t){Ei(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){let i=To(this);e.anchor=!t||i.has(t)?Eo(t||"a",i):t}return new ft(e.anchor)}createNode(e,t,i){let o;if(typeof t=="function")e=t.call({"":e},"",e),o=t;else if(Array.isArray(t)){let _=N=>typeof N=="number"||N instanceof String||N instanceof Number,E=t.filter(_).map(String);E.length>0&&(t=t.concat(E)),o=t}else i===void 0&&t&&(i=t,t=void 0);let{aliasDuplicateObjects:s,anchorPrefix:r,flow:a,keepUndefined:l,onTagObj:c,tag:f}=i??{},{onAnchor:d,setAnchors:u,sourceObjects:y}=pl(this,r||"a"),x={aliasDuplicateObjects:s??!0,keepUndefined:l??!1,onAnchor:d,onTagObj:c,replacer:o,schema:this.schema,sourceObjects:y},h=ht(e,f,x);return a&&q(h)&&(h.flow=!0),u(),h}createPair(e,t,i={}){let o=this.createNode(e,null,i),s=this.createNode(t,null,i);return new H(o,s)}delete(e){return Ei(this.contents)?this.contents.delete(e):!1}deleteIn(e){return Mi(e)?this.contents==null?!1:(this.contents=null,!0):Ei(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return q(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return Mi(e)?!t&&G(this.contents)?this.contents.value:this.contents:q(this.contents)?this.contents.getIn(e,t):void 0}has(e){return q(this.contents)?this.contents.has(e):!1}hasIn(e){return Mi(e)?this.contents!==void 0:q(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=Di(this.schema,[e],t):Ei(this.contents)&&this.contents.set(e,t)}setIn(e,t){Mi(e)?this.contents=t:this.contents==null?this.contents=Di(this.schema,Array.from(e),t):Ei(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let i;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ci({version:"1.1"}),i={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Ci({version:e}),i={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{let o=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${o}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(i)this.schema=new Ki(Object.assign(i,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:i,maxAliasCount:o,onAnchor:s,reviver:r}={}){let a={anchors:new Map,doc:this,keep:!e,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof o=="number"?o:100},l=ie(this.contents,t??"",a);if(typeof s=="function")for(let{count:c,res:f}of a.anchors.values())s(f,c);return typeof r=="function"?Qt(r,{"":l},"",l):l}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){let t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return Il(this,e)}};function Ei(n){if(q(n))return!0;throw new Error("Expected a YAML collection as document contents")}var Ui=class extends Error{constructor(e,t,i,o){super(),this.name=e,this.code=i,this.message=o,this.pos=t}},tt=class extends Ui{constructor(e,t,i){super("YAMLParseError",e,t,i)}},Yi=class extends Ui{constructor(e,t,i){super("YAMLWarning",e,t,i)}},qo=(n,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(a=>e.linePos(a));let{line:i,col:o}=t.linePos[0];t.message+=` at line ${i}, column ${o}`;let s=o-1,r=n.substring(e.lineStarts[i-1],e.lineStarts[i]).replace(/[\n\r]+$/,"");if(s>=60&&r.length>80){let a=Math.min(s-39,r.length-79);r="\u2026"+r.substring(a),s-=a-1}if(r.length>80&&(r=r.substring(0,79)+"\u2026"),i>1&&/^ *$/.test(r.substring(0,s))){let a=n.substring(e.lineStarts[i-2],e.lineStarts[i-1]);a.length>80&&(a=a.substring(0,79)+`\u2026
`),r=a+r}if(/[^ ]/.test(r)){let a=1,l=t.linePos[1];l&&l.line===i&&l.col>o&&(a=Math.max(1,Math.min(l.col-o,80-s)));let c=" ".repeat(s)+"^".repeat(a);t.message+=`:

${r}
${c}
`}};function ct(n,{flow:e,indicator:t,next:i,offset:o,onError:s,parentIndent:r,startOnNewline:a}){let l=!1,c=a,f=a,d="",u="",y=!1,x=!1,h=null,_=null,E=null,N=null,D=null,R=null,V=null;for(let k of n)switch(x&&(k.type!=="space"&&k.type!=="newline"&&k.type!=="comma"&&s(k.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),x=!1),h&&(c&&k.type!=="comment"&&k.type!=="newline"&&s(h,"TAB_AS_INDENT","Tabs are not allowed as indentation"),h=null),k.type){case"space":!e&&(t!=="doc-start"||i?.type!=="flow-collection")&&k.source.includes("	")&&(h=k),f=!0;break;case"comment":{f||s(k,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let Q=k.source.substring(1)||" ";d?d+=u+Q:d=Q,u="",c=!1;break}case"newline":c?d?d+=k.source:(!R||t!=="seq-item-ind")&&(l=!0):u+=k.source,c=!0,y=!0,(_||E)&&(N=k),f=!0;break;case"anchor":_&&s(k,"MULTIPLE_ANCHORS","A node can have at most one anchor"),k.source.endsWith(":")&&s(k.offset+k.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),_=k,V??(V=k.offset),c=!1,f=!1,x=!0;break;case"tag":{E&&s(k,"MULTIPLE_TAGS","A node can have at most one tag"),E=k,V??(V=k.offset),c=!1,f=!1,x=!0;break}case t:(_||E)&&s(k,"BAD_PROP_ORDER",`Anchors and tags must be after the ${k.source} indicator`),R&&s(k,"UNEXPECTED_TOKEN",`Unexpected ${k.source} in ${e??"collection"}`),R=k,c=t==="seq-item-ind"||t==="explicit-key-ind",f=!1;break;case"comma":if(e){D&&s(k,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),D=k,c=!1,f=!1;break}default:s(k,"UNEXPECTED_TOKEN",`Unexpected ${k.type} token`),c=!1,f=!1}let B=n[n.length-1],U=B?B.offset+B.source.length:o;return x&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&s(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),h&&(c&&h.indent<=r||i?.type==="block-map"||i?.type==="block-seq")&&s(h,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:D,found:R,spaceBefore:l,comment:d,hasNewline:y,anchor:_,tag:E,newlineAfterProp:N,end:U,start:V??U}}function ii(n){if(!n)return null;switch(n.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(n.source.includes(`
`))return!0;if(n.end){for(let e of n.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(let e of n.items){for(let t of e.start)if(t.type==="newline")return!0;if(e.sep){for(let t of e.sep)if(t.type==="newline")return!0}if(ii(e.key)||ii(e.value))return!0}return!1;default:return!0}}function Hi(n,e,t){if(e?.type==="flow-collection"){let i=e.end[0];i.indent===n&&(i.source==="]"||i.source==="}")&&ii(e)&&t(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function oo(n,e,t){let{uniqueKeys:i}=n.options;if(i===!1)return!1;let o=typeof i=="function"?i:(s,r)=>s===r||G(s)&&G(r)&&s.value===r.value;return e.some(s=>o(s.key,t))}var Ll="All mapping items must start at the same column";function Al({composeNode:n,composeEmptyNode:e},t,i,o,s){let r=s?.nodeClass??J,a=new r(t.schema);t.atRoot&&(t.atRoot=!1);let l=i.offset,c=null;for(let f of i.items){let{start:d,key:u,sep:y,value:x}=f,h=ct(d,{indicator:"explicit-key-ind",next:u??y?.[0],offset:l,onError:o,parentIndent:i.indent,startOnNewline:!0}),_=!h.found;if(_){if(u&&(u.type==="block-seq"?o(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in u&&u.indent!==i.indent&&o(l,"BAD_INDENT",Ll)),!h.anchor&&!h.tag&&!y){c=h.end,h.comment&&(a.comment?a.comment+=`
`+h.comment:a.comment=h.comment);continue}(h.newlineAfterProp||ii(u))&&o(u??d[d.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else h.found?.indent!==i.indent&&o(l,"BAD_INDENT",Ll);t.atKey=!0;let E=h.end,N=u?n(t,u,h,o):e(t,E,d,null,h,o);t.schema.compat&&Hi(i.indent,u,o),t.atKey=!1,oo(t,a.items,N)&&o(E,"DUPLICATE_KEY","Map keys must be unique");let D=ct(y??[],{indicator:"map-value-ind",next:x,offset:N.range[2],onError:o,parentIndent:i.indent,startOnNewline:!u||u.type==="block-scalar"});if(l=D.end,D.found){_&&(x?.type==="block-map"&&!D.hasNewline&&o(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&h.start<D.found.offset-1024&&o(N.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let R=x?n(t,x,D,o):e(t,l,y,null,D,o);t.schema.compat&&Hi(i.indent,x,o),l=R.range[2];let V=new H(N,R);t.options.keepSourceTokens&&(V.srcToken=f),a.items.push(V)}else{_&&o(N.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),D.comment&&(N.comment?N.comment+=`
`+D.comment:N.comment=D.comment);let R=new H(N);t.options.keepSourceTokens&&(R.srcToken=f),a.items.push(R)}}return c&&c<l&&o(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[i.offset,l,c??l],a}function Dl({composeNode:n,composeEmptyNode:e},t,i,o,s){let r=s?.nodeClass??Ie,a=new r(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let l=i.offset,c=null;for(let{start:f,value:d}of i.items){let u=ct(f,{indicator:"seq-item-ind",next:d,offset:l,onError:o,parentIndent:i.indent,startOnNewline:!0});if(!u.found)if(u.anchor||u.tag||d)d&&d.type==="block-seq"?o(u.end,"BAD_INDENT","All sequence items must start at the same column"):o(l,"MISSING_CHAR","Sequence item without - indicator");else{c=u.end,u.comment&&(a.comment=u.comment);continue}let y=d?n(t,d,u,o):e(t,u.end,f,null,u,o);t.schema.compat&&Hi(i.indent,d,o),l=y.range[2],a.items.push(y)}return a.range=[i.offset,l,c??l],a}function mt(n,e,t,i){let o="";if(n){let s=!1,r="";for(let a of n){let{source:l,type:c}=a;switch(c){case"space":s=!0;break;case"comment":{t&&!s&&i(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let f=l.substring(1)||" ";o?o+=r+f:o=f,r="";break}case"newline":o&&(r+=l),s=!0;break;default:i(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=l.length}}return{comment:o,offset:e}}var Wo="Block collections are not allowed within flow collections",Ko=n=>n&&(n.type==="block-map"||n.type==="block-seq");function Fl({composeNode:n,composeEmptyNode:e},t,i,o,s){let r=i.start.source==="{",a=r?"flow map":"flow sequence",l=s?.nodeClass??(r?J:Ie),c=new l(t.schema);c.flow=!0;let f=t.atRoot;f&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let d=i.offset+i.start.source.length;for(let _=0;_<i.items.length;++_){let E=i.items[_],{start:N,key:D,sep:R,value:V}=E,B=ct(N,{flow:a,indicator:"explicit-key-ind",next:D??R?.[0],offset:d,onError:o,parentIndent:i.indent,startOnNewline:!1});if(!B.found){if(!B.anchor&&!B.tag&&!R&&!V){_===0&&B.comma?o(B.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):_<i.items.length-1&&o(B.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),B.comment&&(c.comment?c.comment+=`
`+B.comment:c.comment=B.comment),d=B.end;continue}!r&&t.options.strict&&ii(D)&&o(D,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(_===0)B.comma&&o(B.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(B.comma||o(B.start,"MISSING_CHAR",`Missing , between ${a} items`),B.comment){let U="";e:for(let k of N)switch(k.type){case"comma":case"space":break;case"comment":U=k.source.substring(1);break e;default:break e}if(U){let k=c.items[c.items.length-1];j(k)&&(k=k.value??k.key),k.comment?k.comment+=`
`+U:k.comment=U,B.comment=B.comment.substring(U.length+1)}}if(!r&&!R&&!B.found){let U=V?n(t,V,B,o):e(t,B.end,R,null,B,o);c.items.push(U),d=U.range[2],Ko(V)&&o(U.range,"BLOCK_IN_FLOW",Wo)}else{t.atKey=!0;let U=B.end,k=D?n(t,D,B,o):e(t,U,N,null,B,o);Ko(D)&&o(k.range,"BLOCK_IN_FLOW",Wo),t.atKey=!1;let Q=ct(R??[],{flow:a,indicator:"map-value-ind",next:V,offset:k.range[2],onError:o,parentIndent:i.indent,startOnNewline:!1});if(Q.found){if(!r&&!B.found&&t.options.strict){if(R)for(let Z of R){if(Z===Q.found)break;if(Z.type==="newline"){o(Z,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}B.start<Q.found.offset-1024&&o(Q.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else V&&("source"in V&&V.source&&V.source[0]===":"?o(V,"MISSING_CHAR",`Missing space after : in ${a}`):o(Q.start,"MISSING_CHAR",`Missing , or : between ${a} items`));let _t=V?n(t,V,Q,o):Q.found?e(t,Q.end,R,null,Q,o):null;_t?Ko(V)&&o(_t.range,"BLOCK_IN_FLOW",Wo):Q.comment&&(k.comment?k.comment+=`
`+Q.comment:k.comment=Q.comment);let pi=new H(k,_t);if(t.options.keepSourceTokens&&(pi.srcToken=E),r){let Z=c;oo(t,Z.items,k)&&o(U,"DUPLICATE_KEY","Map keys must be unique"),Z.items.push(pi)}else{let Z=new J(t.schema);Z.flow=!0,Z.items.push(pi);let os=(_t??k).range;Z.range=[k.range[0],os[1],os[2]],c.items.push(Z)}d=_t?_t.range[2]:Q.end}}let u=r?"}":"]",[y,...x]=i.end,h=d;if(y&&y.source===u)h=y.offset+y.source.length;else{let _=a[0].toUpperCase()+a.substring(1),E=f?`${_} must end with a ${u}`:`${_} in block collection must be sufficiently indented and end with a ${u}`;o(d,f?"MISSING_CHAR":"BAD_INDENT",E),y&&y.source.length!==1&&x.unshift(y)}if(x.length>0){let _=mt(x,h,t.options.strict,o);_.comment&&(c.comment?c.comment+=`
`+_.comment:c.comment=_.comment),c.range=[i.offset,h,_.offset]}else c.range=[i.offset,h,h];return c}function Uo(n,e,t,i,o,s){let r=t.type==="block-map"?Al(n,e,t,i,s):t.type==="block-seq"?Dl(n,e,t,i,s):Fl(n,e,t,i,s),a=r.constructor;return o==="!"||o===a.tagName?(r.tag=a.tagName,r):(o&&(r.tag=o),r)}function Rl(n,e,t,i,o){let s=i.tag,r=s?e.directives.tagName(s.source,u=>o(s,"TAG_RESOLVE_FAILED",u)):null;if(t.type==="block-seq"){let{anchor:u,newlineAfterProp:y}=i,x=u&&s?u.offset>s.offset?u:s:u??s;x&&(!y||y.offset<x.offset)&&o(x,"MISSING_CHAR","Missing newline after block sequence props")}let a=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!s||!r||r==="!"||r===J.tagName&&a==="map"||r===Ie.tagName&&a==="seq")return Uo(n,e,t,o,r);let l=e.schema.tags.find(u=>u.tag===r&&u.collection===a);if(!l){let u=e.schema.knownTags[r];if(u&&u.collection===a)e.schema.tags.push(Object.assign({},u,{default:!1})),l=u;else return u?o(s,"BAD_COLLECTION_TYPE",`${u.tag} used for ${a} collection, but expects ${u.collection??"scalar"}`,!0):o(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,!0),Uo(n,e,t,o,r)}let c=Uo(n,e,t,o,r,l),f=l.resolve?.(c,u=>o(s,"TAG_RESOLVE_FAILED",u),e.options)??c,d=$(f)?f:new L(f);return d.range=c.range,d.tag=r,l?.format&&(d.format=l.format),d}function Yo(n,e,t){let i=e.offset,o=Au(e,n.options.strict,t);if(!o)return{value:"",type:null,comment:"",range:[i,i,i]};let s=o.mode===">"?L.BLOCK_FOLDED:L.BLOCK_LITERAL,r=e.source?Du(e.source):[],a=r.length;for(let h=r.length-1;h>=0;--h){let _=r[h][1];if(_===""||_==="\r")a=h;else break}if(a===0){let h=o.chomp==="+"&&r.length>0?`
`.repeat(Math.max(1,r.length-1)):"",_=i+o.length;return e.source&&(_+=e.source.length),{value:h,type:s,comment:o.comment,range:[i,_,_]}}let l=e.indent+o.indent,c=e.offset+o.length,f=0;for(let h=0;h<a;++h){let[_,E]=r[h];if(E===""||E==="\r")o.indent===0&&_.length>l&&(l=_.length);else{_.length<l&&t(c+_.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),o.indent===0&&(l=_.length),f=h,l===0&&!n.atRoot&&t(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=_.length+E.length+1}for(let h=r.length-1;h>=a;--h)r[h][0].length>l&&(a=h+1);let d="",u="",y=!1;for(let h=0;h<f;++h)d+=r[h][0].slice(l)+`
`;for(let h=f;h<a;++h){let[_,E]=r[h];c+=_.length+E.length+1;let N=E[E.length-1]==="\r";if(N&&(E=E.slice(0,-1)),E&&_.length<l){let R=`Block scalar lines must not be less indented than their ${o.indent?"explicit indentation indicator":"first line"}`;t(c-E.length-(N?2:1),"BAD_INDENT",R),_=""}s===L.BLOCK_LITERAL?(d+=u+_.slice(l)+E,u=`
`):_.length>l||E[0]==="	"?(u===" "?u=`
`:!y&&u===`
`&&(u=`

`),d+=u+_.slice(l)+E,u=`
`,y=!0):E===""?u===`
`?d+=`
`:u=`
`:(d+=u+E,u=" ",y=!1)}switch(o.chomp){case"-":break;case"+":for(let h=a;h<r.length;++h)d+=`
`+r[h][0].slice(l);d[d.length-1]!==`
`&&(d+=`
`);break;default:d+=`
`}let x=i+o.length+e.source.length;return{value:d,type:s,comment:o.comment,range:[i,x,x]}}function Au({offset:n,props:e},t,i){if(e[0].type!=="block-scalar-header")return i(e[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:o}=e[0],s=o[0],r=0,a="",l=-1;for(let u=1;u<o.length;++u){let y=o[u];if(!a&&(y==="-"||y==="+"))a=y;else{let x=Number(y);!r&&x?r=x:l===-1&&(l=n+u)}}l!==-1&&i(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${o}`);let c=!1,f="",d=o.length;for(let u=1;u<e.length;++u){let y=e[u];switch(y.type){case"space":c=!0;case"newline":d+=y.source.length;break;case"comment":t&&!c&&i(y,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),d+=y.source.length,f=y.source.substring(1);break;case"error":i(y,"UNEXPECTED_TOKEN",y.message),d+=y.source.length;break;default:{let x=`Unexpected token in block scalar header: ${y.type}`;i(y,"UNEXPECTED_TOKEN",x);let h=y.source;h&&typeof h=="string"&&(d+=h.length)}}}return{mode:s,indent:r,chomp:a,comment:f,length:d}}function Du(n){let e=n.split(/\n( *)/),t=e[0],i=t.match(/^( *)/),s=[i?.[1]?[i[1],t.slice(i[1].length)]:["",t]];for(let r=1;r<e.length;r+=2)s.push([e[r],e[r+1]]);return s}function Ho(n,e,t){let{offset:i,type:o,source:s,end:r}=n,a,l,c=(u,y,x)=>t(i+u,y,x);switch(o){case"scalar":a=L.PLAIN,l=Fu(s,c);break;case"single-quoted-scalar":a=L.QUOTE_SINGLE,l=Ru(s,c);break;case"double-quoted-scalar":a=L.QUOTE_DOUBLE,l=Vu(s,c);break;default:return t(n,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${o}`),{value:"",type:null,comment:"",range:[i,i+s.length,i+s.length]}}let f=i+s.length,d=mt(r,f,e,t);return{value:l,type:a,comment:d.comment,range:[i,f,d.offset]}}function Fu(n,e){let t="";switch(n[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${n[0]}`;break}case"@":case"`":{t=`reserved character ${n[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),Vl(n)}function Ru(n,e){return(n[n.length-1]!=="'"||n.length===1)&&e(n.length,"MISSING_CHAR","Missing closing 'quote"),Vl(n.slice(1,-1)).replace(/''/g,"'")}function Vl(n){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=e.exec(n);if(!i)return n;let o=i[1],s=" ",r=e.lastIndex;for(t.lastIndex=r;i=t.exec(n);)i[1]===""?s===`
`?o+=s:s=`
`:(o+=s+i[1],s=" "),r=t.lastIndex;let a=/[ \t]*(.*)/sy;return a.lastIndex=r,i=a.exec(n),o+s+(i?.[1]??"")}function Vu(n,e){let t="";for(let i=1;i<n.length-1;++i){let o=n[i];if(!(o==="\r"&&n[i+1]===`
`))if(o===`
`){let{fold:s,offset:r}=Bu(n,i);t+=s,i=r}else if(o==="\\"){let s=n[++i],r=Gu[s];if(r)t+=r;else if(s===`
`)for(s=n[i+1];s===" "||s==="	";)s=n[++i+1];else if(s==="\r"&&n[i+1]===`
`)for(s=n[++i+1];s===" "||s==="	";)s=n[++i+1];else if(s==="x"||s==="u"||s==="U"){let a={x:2,u:4,U:8}[s];t+=ju(n,i+1,a,e),i+=a}else{let a=n.substr(i-1,2);e(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),t+=a}}else if(o===" "||o==="	"){let s=i,r=n[i+1];for(;r===" "||r==="	";)r=n[++i+1];r!==`
`&&!(r==="\r"&&n[i+2]===`
`)&&(t+=i>s?n.slice(s,i+1):o)}else t+=o}return(n[n.length-1]!=='"'||n.length===1)&&e(n.length,"MISSING_CHAR",'Missing closing "quote'),t}function Bu(n,e){let t="",i=n[e+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&n[e+2]!==`
`);)i===`
`&&(t+=`
`),e+=1,i=n[e+1];return t||(t=" "),{fold:t,offset:e}}var Gu={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function ju(n,e,t,i){let o=n.substr(e,t),r=o.length===t&&/^[0-9a-fA-F]+$/.test(o)?parseInt(o,16):NaN;if(isNaN(r)){let a=n.substr(e-2,t+2);return i(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(r)}function zo(n,e,t,i){let{value:o,type:s,comment:r,range:a}=e.type==="block-scalar"?Yo(n,e,i):Ho(e,n.options.strict,i),l=t?n.directives.tagName(t.source,d=>i(t,"TAG_RESOLVE_FAILED",d)):null,c;n.options.stringKeys&&n.atKey?c=n.schema[je]:l?c=$u(n.schema,o,l,t,i):e.type==="scalar"?c=qu(n,o,e,i):c=n.schema[je];let f;try{let d=c.resolve(o,u=>i(t??e,"TAG_RESOLVE_FAILED",u),n.options);f=G(d)?d:new L(d)}catch(d){let u=d instanceof Error?d.message:String(d);i(t??e,"TAG_RESOLVE_FAILED",u),f=new L(o)}return f.range=a,f.source=o,s&&(f.type=s),l&&(f.tag=l),c.format&&(f.format=c.format),r&&(f.comment=r),f}function $u(n,e,t,i,o){if(t==="!")return n[je];let s=[];for(let a of n.tags)if(!a.collection&&a.tag===t)if(a.default&&a.test)s.push(a);else return a;for(let a of s)if(a.test?.test(e))return a;let r=n.knownTags[t];return r&&!r.collection?(n.tags.push(Object.assign({},r,{default:!1,test:void 0})),r):(o(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),n[je])}function qu({atKey:n,directives:e,schema:t},i,o,s){let r=t.tags.find(a=>(a.default===!0||n&&a.default==="key")&&a.test?.test(i))||t[je];if(t.compat){let a=t.compat.find(l=>l.default&&l.test?.test(i))??t[je];if(r.tag!==a.tag){let l=e.tagString(r.tag),c=e.tagString(a.tag),f=`Value may be parsed as either ${l} or ${c}`;s(o,"TAG_RESOLVE_FAILED",f,!0)}}return r}function Bl(n,e,t){if(e){t??(t=e.length);for(let i=t-1;i>=0;--i){let o=e[i];switch(o.type){case"space":case"comment":case"newline":n-=o.source.length;continue}for(o=e[++i];o?.type==="space";)n+=o.source.length,o=e[++i];break}}return n}var Wu={composeNode:Xo,composeEmptyNode:so};function Xo(n,e,t,i){let o=n.atKey,{spaceBefore:s,comment:r,anchor:a,tag:l}=t,c,f=!0;switch(e.type){case"alias":c=Ku(n,e,i),(a||l)&&i(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=zo(n,e,l,i),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Rl(Wu,n,e,t,i),a&&(c.anchor=a.source.substring(1));break;default:{let d=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;i(e,"UNEXPECTED_TOKEN",d),c=so(n,e.offset,void 0,null,t,i),f=!1}}return a&&c.anchor===""&&i(a,"BAD_ALIAS","Anchor cannot be an empty string"),o&&n.options.stringKeys&&(!G(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&i(l??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),s&&(c.spaceBefore=!0),r&&(e.type==="scalar"&&e.source===""?c.comment=r:c.commentBefore=r),n.options.keepSourceTokens&&f&&(c.srcToken=e),c}function so(n,e,t,i,{spaceBefore:o,comment:s,anchor:r,tag:a,end:l},c){let f={type:"scalar",offset:Bl(e,t,i),indent:-1,source:""},d=zo(n,f,a,c);return r&&(d.anchor=r.source.substring(1),d.anchor===""&&c(r,"BAD_ALIAS","Anchor cannot be an empty string")),o&&(d.spaceBefore=!0),s&&(d.comment=s,d.range[2]=l),d}function Ku({options:n},{offset:e,source:t,end:i},o){let s=new ft(t.substring(1));s.source===""&&o(e,"BAD_ALIAS","Alias cannot be an empty string"),s.source.endsWith(":")&&o(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let r=e+t.length,a=mt(i,r,n.strict,o);return s.range=[e,r,a.offset],a.comment&&(s.comment=a.comment),s}function Gl(n,e,{offset:t,start:i,value:o,end:s},r){let a=Object.assign({_directives:e},n),l=new yt(void 0,a),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},f=ct(i,{indicator:"doc-start",next:o??s?.[0],offset:t,onError:r,parentIndent:0,startOnNewline:!0});f.found&&(l.directives.docStart=!0,o&&(o.type==="block-map"||o.type==="block-seq")&&!f.hasNewline&&r(f.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=o?Xo(c,o,f,r):so(c,f.end,i,null,f,r);let d=l.contents.range[2],u=mt(s,d,!1,r);return u.comment&&(l.comment=u.comment),l.range=[t,d,u.offset],l}function zi(n){if(typeof n=="number")return[n,n+1];if(Array.isArray(n))return n.length===2?n:[n[0],n[1]];let{offset:e,source:t}=n;return[e,e+(typeof t=="string"?t.length:1)]}function jl(n){let e="",t=!1,i=!1;for(let o=0;o<n.length;++o){let s=n[o];switch(s[0]){case"#":e+=(e===""?"":i?`

`:`
`)+(s.substring(1)||" "),t=!0,i=!1;break;case"%":n[o+1]?.[0]!=="#"&&(o+=1),t=!1;break;default:t||(i=!0),t=!1}}return{comment:e,afterEmptyLine:i}}var Xi=class{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,i,o,s)=>{let r=zi(t);s?this.warnings.push(new Yi(r,i,o)):this.errors.push(new tt(r,i,o))},this.directives=new Ci({version:e.version||"1.2"}),this.options=e}decorate(e,t){let{comment:i,afterEmptyLine:o}=jl(this.prelude);if(i){let s=e.contents;if(t)e.comment=e.comment?`${e.comment}
${i}`:i;else if(o||e.directives.docStart||!s)e.commentBefore=i;else if(q(s)&&!s.flow&&s.items.length>0){let r=s.items[0];j(r)&&(r=r.key);let a=r.commentBefore;r.commentBefore=a?`${i}
${a}`:i}else{let r=s.commentBefore;s.commentBefore=r?`${i}
${r}`:i}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:jl(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,i=-1){for(let o of e)yield*g(this.next(o));yield*g(this.end(t,i))}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,i,o)=>{let s=zi(e);s[0]+=t,this.onError(s,"BAD_DIRECTIVE",i,o)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let t=Gl(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,i=new tt(zi(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){let i="Unexpected doc-end without preceding document";this.errors.push(new tt(zi(e),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;let t=mt(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){let i=this.doc.comment;this.doc.comment=i?`${i}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new tt(zi(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let i=Object.assign({_directives:this.directives},this.options),o=new yt(void 0,i);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),o.range=[0,t,t],this.decorate(o,!1),yield o}}};var Jo=Symbol("break visit"),Uu=Symbol("skip children"),$l=Symbol("remove item");function mi(n,e){"type"in n&&n.type==="document"&&(n={start:n.start,value:n.value}),ql(Object.freeze([]),n,e)}mi.BREAK=Jo;mi.SKIP=Uu;mi.REMOVE=$l;mi.itemAtPath=(n,e)=>{let t=n;for(let[i,o]of e){let s=t?.[i];if(s&&"items"in s)t=s.items[o];else return}return t};mi.parentCollection=(n,e)=>{let t=mi.itemAtPath(n,e.slice(0,-1)),i=e[e.length-1][0],o=t?.[i];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};function ql(n,e,t){let i=t(e,n);if(typeof i=="symbol")return i;for(let o of["key","value"]){let s=e[o];if(s&&"items"in s){for(let r=0;r<s.items.length;++r){let a=ql(Object.freeze(n.concat([[o,r]])),s.items[r],t);if(typeof a=="number")r=a-1;else{if(a===Jo)return Jo;a===$l&&(s.items.splice(r,1),r-=1)}}typeof i=="function"&&o==="key"&&(i=i(e,n))}}return typeof i=="function"?i(e,n):i}var Qo="\uFEFF",Zo="",es="",ro="";function Wl(n){switch(n){case Qo:return"byte-order-mark";case Zo:return"doc-mode";case es:return"flow-error-end";case ro:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(n[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}function it(n){switch(n){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var Kl=new Set("0123456789ABCDEFabcdef"),Hu=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),ao=new Set(",[]{}"),zu=new Set(` ,[]{}
\r	`),ts=n=>!n||zu.has(n),Ji=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let i=this.next??"stream";for(;i&&(t||this.hasChars(1));)i=yield*g(this.parseNext(i))}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let i=0;for(;t===" ";)t=this.buffer[++i+e];if(t==="\r"){let o=this.buffer[i+e+1];if(o===`
`||!o&&!this.atEnd)return e+i+1}return t===`
`||i>=this.indentNext||!t&&!this.atEnd?e+i:-1}if(t==="-"||t==="."){let i=this.buffer.substr(e,3);if((i==="---"||i==="...")&&it(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*g(this.parseStream());case"line-start":return yield*g(this.parseLineStart());case"block-start":return yield*g(this.parseBlockStart());case"doc":return yield*g(this.parseDocument());case"flow":return yield*g(this.parseFlowCollection());case"quoted-scalar":return yield*g(this.parseQuotedScalar());case"block-scalar":return yield*g(this.parseBlockScalar());case"plain-scalar":return yield*g(this.parsePlainScalar())}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Qo&&(yield*g(this.pushCount(1)),e=e.substring(1)),e[0]==="%"){let t=e.length,i=e.indexOf("#");for(;i!==-1;){let s=e[i-1];if(s===" "||s==="	"){t=i-1;break}else i=e.indexOf("#",i+1)}for(;;){let s=e[t-1];if(s===" "||s==="	")t-=1;else break}let o=(yield*g(this.pushCount(t)))+(yield*g(this.pushSpaces(!0)));return yield*g(this.pushCount(e.length-o)),this.pushNewline(),"stream"}if(this.atLineEnd()){let t=yield*g(this.pushSpaces(!0));return yield*g(this.pushCount(e.length-t)),yield*g(this.pushNewline()),"stream"}return yield Zo,yield*g(this.parseLineStart())}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let t=this.peek(3);if((t==="---"||t==="...")&&it(this.charAt(3)))return yield*g(this.pushCount(3)),this.indentValue=0,this.indentNext=0,t==="---"?"doc":"stream"}return this.indentValue=yield*g(this.pushSpaces(!1)),this.indentNext>this.indentValue&&!it(this.charAt(1))&&(this.indentNext=this.indentValue),yield*g(this.parseBlockStart())}*parseBlockStart(){let[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&it(t)){let i=(yield*g(this.pushCount(1)))+(yield*g(this.pushSpaces(!0)));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*g(this.parseBlockStart())}return"doc"}*parseDocument(){yield*g(this.pushSpaces(!0));let e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*g(this.pushIndicators());switch(e[t]){case"#":yield*g(this.pushCount(e.length-t));case void 0:return yield*g(this.pushNewline()),yield*g(this.parseLineStart());case"{":case"[":return yield*g(this.pushCount(1)),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*g(this.pushCount(1)),"doc";case"*":return yield*g(this.pushUntil(ts)),"doc";case'"':case"'":return yield*g(this.parseQuotedScalar());case"|":case">":return t+=yield*g(this.parseBlockScalarHeader()),t+=yield*g(this.pushSpaces(!0)),yield*g(this.pushCount(e.length-t)),yield*g(this.pushNewline()),yield*g(this.parseBlockScalar());default:return yield*g(this.parsePlainScalar())}}*parseFlowCollection(){let e,t,i=-1;do e=yield*g(this.pushNewline()),e>0?(t=yield*g(this.pushSpaces(!1)),this.indentValue=i=t):t=0,t+=yield*g(this.pushSpaces(!0));while(e+t>0);let o=this.getLine();if(o===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&o[0]!=="#"||i===0&&(o.startsWith("---")||o.startsWith("..."))&&it(o[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(o[0]==="]"||o[0]==="}")))return this.flowLevel=0,yield es,yield*g(this.parseLineStart());let s=0;for(;o[s]===",";)s+=yield*g(this.pushCount(1)),s+=yield*g(this.pushSpaces(!0)),this.flowKey=!1;switch(s+=yield*g(this.pushIndicators()),o[s]){case void 0:return"flow";case"#":return yield*g(this.pushCount(o.length-s)),"flow";case"{":case"[":return yield*g(this.pushCount(1)),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*g(this.pushCount(1)),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*g(this.pushUntil(ts)),"flow";case'"':case"'":return this.flowKey=!0,yield*g(this.parseQuotedScalar());case":":{let r=this.charAt(1);if(this.flowKey||it(r)||r===",")return this.flowKey=!1,yield*g(this.pushCount(1)),yield*g(this.pushSpaces(!0)),"flow"}default:return this.flowKey=!1,yield*g(this.parsePlainScalar())}}*parseQuotedScalar(){let e=this.charAt(0),t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let s=0;for(;this.buffer[t-1-s]==="\\";)s+=1;if(s%2===0)break;t=this.buffer.indexOf('"',t+1)}let i=this.buffer.substring(0,t),o=i.indexOf(`
`,this.pos);if(o!==-1){for(;o!==-1;){let s=this.continueScalar(o+1);if(s===-1)break;o=i.indexOf(`
`,s)}o!==-1&&(t=o-(i[o-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*g(this.pushToIndex(t+1,!1)),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*g(this.pushUntil(t=>it(t)||t==="#"))}*parseBlockScalar(){let e=this.pos-1,t=0,i;e:for(let s=this.pos;i=this.buffer[s];++s)switch(i){case" ":t+=1;break;case`
`:e=s,t=0;break;case"\r":{let r=this.buffer[s+1];if(!r&&!this.atEnd)return this.setNext("block-scalar");if(r===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let o=e+1;for(i=this.buffer[o];i===" ";)i=this.buffer[++o];if(i==="	"){for(;i==="	"||i===" "||i==="\r"||i===`
`;)i=this.buffer[++o];e=o-1}else if(!this.blockScalarKeep)do{let s=e-1,r=this.buffer[s];r==="\r"&&(r=this.buffer[--s]);let a=s;for(;r===" ";)r=this.buffer[--s];if(r===`
`&&s>=this.pos&&s+1+t>a)e=s;else break}while(!0);return yield ro,yield*g(this.pushToIndex(e+1,!0)),yield*g(this.parseLineStart())}*parsePlainScalar(){let e=this.flowLevel>0,t=this.pos-1,i=this.pos-1,o;for(;o=this.buffer[++i];)if(o===":"){let s=this.buffer[i+1];if(it(s)||e&&ao.has(s))break;t=i}else if(it(o)){let s=this.buffer[i+1];if(o==="\r"&&(s===`
`?(i+=1,o=`
`,s=this.buffer[i+1]):t=i),s==="#"||e&&ao.has(s))break;if(o===`
`){let r=this.continueScalar(i+1);if(r===-1)break;i=Math.max(i,r-2)}}else{if(e&&ao.has(o))break;t=i}return!o&&!this.atEnd?this.setNext("plain-scalar"):(yield ro,yield*g(this.pushToIndex(t+1,!0)),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){let i=this.buffer.slice(this.pos,e);return i?(yield i,this.pos+=i.length,i.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*g(this.pushTag()))+(yield*g(this.pushSpaces(!0)))+(yield*g(this.pushIndicators()));case"&":return(yield*g(this.pushUntil(ts)))+(yield*g(this.pushSpaces(!0)))+(yield*g(this.pushIndicators()));case"-":case"?":case":":{let e=this.flowLevel>0,t=this.charAt(1);if(it(t)||e&&ao.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*g(this.pushCount(1)))+(yield*g(this.pushSpaces(!0)))+(yield*g(this.pushIndicators()))}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!it(t)&&t!==">";)t=this.buffer[++e];return yield*g(this.pushToIndex(t===">"?e+1:e,!1))}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(Hu.has(t))t=this.buffer[++e];else if(t==="%"&&Kl.has(this.buffer[e+1])&&Kl.has(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*g(this.pushToIndex(e,!1))}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*g(this.pushCount(1)):e==="\r"&&this.charAt(1)===`
`?yield*g(this.pushCount(2)):0}*pushSpaces(e){let t=this.pos-1,i;do i=this.buffer[++t];while(i===" "||e&&i==="	");let o=t-this.pos;return o>0&&(yield this.buffer.substr(this.pos,o),this.pos=t),o}*pushUntil(e){let t=this.pos,i=this.buffer[t];for(;!e(i);)i=this.buffer[++t];return yield*g(this.pushToIndex(t,!1))}};var Qi=class{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,i=this.lineStarts.length;for(;t<i;){let s=t+i>>1;this.lineStarts[s]<e?t=s+1:i=s}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};let o=this.lineStarts[t-1];return{line:t,col:e-o+1}}}};function ni(n,e){for(let t=0;t<n.length;++t)if(n[t].type===e)return!0;return!1}function Ul(n){for(let e=0;e<n.length;++e)switch(n[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function Hl(n){switch(n?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function lo(n){switch(n.type){case"document":return n.start;case"block-map":{let e=n.items[n.items.length-1];return e.sep??e.start}case"block-seq":return n.items[n.items.length-1].start;default:return[]}}function Ni(n){if(n.length===0)return[];let e=n.length;e:for(;--e>=0;)switch(n[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;n[++e]?.type==="space";);return n.splice(e,n.length)}function Yl(n){if(n.start.type==="flow-seq-start")for(let e of n.items)e.sep&&!e.value&&!ni(e.start,"explicit-key-ind")&&!ni(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,Hl(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}var Zi=class{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Ji,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let i of this.lexer.lex(e,t))yield*g(this.next(i));t||(yield*g(this.end()))}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*g(this.step()),this.offset+=e.length;return}let t=Wl(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*g(this.step()),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{let i=`Not a YAML token: ${e}`;yield*g(this.pop({type:"error",offset:this.offset,message:i,source:e})),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*g(this.pop())}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*g(this.pop());this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*g(this.stream());switch(e.type){case"document":return yield*g(this.document(e));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*g(this.scalar(e));case"block-scalar":return yield*g(this.blockScalar(e));case"block-map":return yield*g(this.blockMap(e));case"block-seq":return yield*g(this.blockSequence(e));case"flow-collection":return yield*g(this.flowCollection(e));case"doc-end":return yield*g(this.documentEnd(e))}yield*g(this.pop())}peek(e){return this.stack[this.stack.length-e]}*pop(e){let t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{let i=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in i?i.indent:0:t.type==="flow-collection"&&i.type==="document"&&(t.indent=0),t.type==="flow-collection"&&Yl(t),i.type){case"document":i.value=t;break;case"block-scalar":i.props.push(t);break;case"block-map":{let o=i.items[i.items.length-1];if(o.value){i.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(o.sep)o.value=t;else{Object.assign(o,{key:t,sep:[]}),this.onKeyLine=!o.explicitKey;return}break}case"block-seq":{let o=i.items[i.items.length-1];o.value?i.items.push({start:[],value:t}):o.value=t;break}case"flow-collection":{let o=i.items[i.items.length-1];!o||o.value?i.items.push({start:[],key:t,sep:[]}):o.sep?o.value=t:Object.assign(o,{key:t,sep:[]});return}default:yield*g(this.pop()),yield*g(this.pop(t))}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){let o=t.items[t.items.length-1];o&&!o.sep&&!o.value&&o.start.length>0&&Ul(o.start)===-1&&(t.indent===0||o.start.every(s=>s.type!=="comment"||s.indent<t.indent))&&(i.type==="document"?i.end=o.start:i.items.push({start:o.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*g(this.lineEnd(e));switch(this.type){case"doc-start":{Ul(e.start)!==-1?(yield*g(this.pop()),yield*g(this.step())):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){let t=lo(this.peek(2)),i=Ni(t),o;e.end?(o=e.end,o.push(this.sourceToken),delete e.end):o=[this.sourceToken];let s={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:i,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=s}else yield*g(this.lineEnd(e))}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*g(this.pop());break;default:yield*g(this.pop()),yield*g(this.step())}}*blockMap(e){let t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){let i="end"in t.value?t.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let i=!this.onKeyLine&&this.indent===e.indent,o=i&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind",s=[];if(o&&t.sep&&!t.value){let r=[];for(let a=0;a<t.sep.length;++a){let l=t.sep[a];switch(l.type){case"newline":r.push(a);break;case"space":break;case"comment":l.indent>e.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(s=t.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":o||t.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):o||t.value?(s.push(this.sourceToken),e.items.push({start:s,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(ni(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(Hl(t.key)&&!ni(t.sep,"newline")){let r=Ni(t.start),a=t.key,l=t.sep;l.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:a,sep:l}]})}else s.length>0?t.sep=t.sep.concat(s,this.sourceToken):t.sep.push(this.sourceToken);else if(ni(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{let r=Ni(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||o?e.items.push({start:s,key:null,sep:[this.sourceToken]}):ni(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let r=this.flowScalar(this.type);o||t.value?(e.items.push({start:s,key:r,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(r):(Object.assign(t,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{let r=this.startBlockValue(e);if(r){if(r.type==="block-seq"){if(!t.explicitKey&&t.sep&&!ni(t.sep,"newline")){yield*g(this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source}));return}}else i&&e.items.push({start:s});this.stack.push(r);return}}}}yield*g(this.pop()),yield*g(this.step())}*blockSequence(e){let t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){let i="end"in t.value?t.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||ni(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){let i=this.startBlockValue(e);if(i){this.stack.push(i);return}}yield*g(this.pop()),yield*g(this.step())}*flowCollection(e){let t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let i;do yield*g(this.pop()),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let o=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:o,sep:[]}):t.sep?this.stack.push(o):Object.assign(t,{key:o,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let i=this.startBlockValue(e);i?this.stack.push(i):(yield*g(this.pop()),yield*g(this.step()))}else{let i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===e.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*g(this.pop()),yield*g(this.step());else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){let o=lo(i),s=Ni(o);Yl(e);let r=e.end.splice(1,e.end.length);r.push(this.sourceToken);let a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*g(this.lineEnd(e))}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let t=lo(e),i=Ni(t);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let t=lo(e),i=Ni(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*g(this.pop())))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*g(this.pop()),yield*g(this.step());break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*g(this.pop()))}}};function Xu(n){let e=n.prettyErrors!==!1;return{lineCounter:n.lineCounter||e&&new Qi||null,prettyErrors:e}}function zl(n,e={}){let{lineCounter:t,prettyErrors:i}=Xu(e),o=new Zi(t?.addNewLine),s=new Xi(e),r=null;for(let a of s.compose(o.parse(n),!0,n.length))if(!r)r=a;else if(r.options.logLevel!=="silent"){r.errors.push(new tt(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&t&&(r.errors.forEach(qo(n,t)),r.warnings.forEach(qo(n,t))),r}function is(n,e,t){let i;typeof e=="function"?i=e:t===void 0&&e&&typeof e=="object"&&(t=e);let o=zl(n,t);if(!o)return null;if(o.warnings.forEach(s=>Gn(o.options.logLevel,s)),o.errors.length>0){if(o.options.logLevel!=="silent")throw o.errors[0];o.errors=[]}return o.toJS(Object.assign({reviver:i},t))}function ns(n,e,t){let i=null;if(typeof e=="function"||Array.isArray(e)?i=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){let o=Math.round(t);t=o<1?void 0:o>8?{indent:8}:{indent:o}}if(n===void 0){let{keepUndefined:o}=t??e??{};if(!o)return}return ze(n)&&!i?n.toString(t):new yt(n,i,t).toString(t)}var en=class n{static geometryToCsv(e){if(!e)return"";let t=o=>{if(o==null)return"";let s=String(o),r=/[",\n]/.test(s),a=s.replace(/"/g,'""');return r?`"${a}"`:a},i=[];i.push("SOLVER_CONFIGURATION"),i.push(["SolverType"].join(",")),i.push([t(e.solverConfiguration?.solverType)].join(",")),i.push(""),i.push("MESHING_CONFIGURATION"),i.push(["MaxTriangleArea"].join(",")),i.push([t(e.meshingConfiguration?.maxMeshArea)].join(",")),i.push(""),i.push("REFINEMENT_POINTS"),i.push(["X","Y","Radius","MaxArea"].join(","));for(let o of e.meshingConfiguration?.refinementPoints??[])i.push([t(o.x),t(o.y),t(o.radius),t(o.maxArea)].join(","));i.push(""),i.push("RESULT_POINTS"),i.push(["Name","X","Y"].join(","));for(let o of e.resultPoints??[])i.push([t(o.name),t(o.x),t(o.y)].join(","));i.push(""),i.push("MATERIALS"),i.push(["Name","ModulusOfElasticity","PoissonsRatio","Weight"].join(","));for(let o of e.materials??[])i.push([t(o.name),t(o.modulusOfElasticity),t(o.poissonsRatio),t(o.weight)].join(","));i.push(""),i.push("SECTION_PROPERTIES"),i.push(["Name","Thickness"].join(","));for(let o of e.sectionProperties??[])i.push([t(o.name),t(o.thickness)].join(","));i.push(""),i.push("RECTANGLE_GEOMETRY"),i.push(["Name","X","Y","Width","Height","SectionName","MaterialName"].join(","));for(let o of e.rectangles??[])i.push([t(o.name),t(o.x),t(o.y),t(o.width),t(o.height),t(o.sectionName),t(o.materialName)].join(","));i.push(""),i.push("POLYGONS"),i.push(["Name","Points","SectionName","MaterialName"].join(","));for(let o of e.polygons??[])i.push([t(o.name),t(o.points),t(o.sectionName),t(o.materialName)].join(","));i.push(""),i.push("SUPPORTS"),i.push(["X","Y","FixedX","FixedY"].join(","));for(let o of e.supports??[])i.push([t(o.x),t(o.y),t(o.fixedX),t(o.fixedY)].join(","));i.push(""),i.push("LOAD_CASES"),i.push(["LoadCase","Type","GeometryOrPointName","X","Y","FX","FY"].join(","));for(let o of e.loadCases??[]){for(let s of o.pointLoads??[])i.push([t(o.name),"Point","",t(s.x),t(s.y),t(s.fx),t(s.fy)].join(","));for(let s of o.distributedLoads??[])i.push([t(o.name),"Distributed",t(s.geometryName),"","",t(s.fx),t(s.fy)].join(","))}return i.push(""),i.join(`
`)}static parseCsvRow(e){let t=[],i="",o=!1;for(let s=0;s<e.length;s++){let r=e[s];o?r==='"'?s+1<e.length&&e[s+1]==='"'?(i+='"',s++):o=!1:i+=r:r==='"'?o=!0:r===","?(t.push(i),i=""):i+=r}return t.push(i),t.map(s=>s.trim())}static parseGeometryFromCsv(e){let i=(e??"").replace(/^\uFEFF/,"").split(/\r?\n/).map(f=>f.trim()),o=new Set(["SOLVER_CONFIGURATION","MESHING_CONFIGURATION","REFINEMENT_POINTS","RESULT_POINTS","MATERIALS","SECTION_PROPERTIES","RECTANGLE_GEOMETRY","POLYGONS","SUPPORTS","LOAD_CASES"]),s=0,r=()=>{for(;s<i.length&&i[s].length===0;)s++;return s<i.length?i[s]:null},a=f=>{if(r()!==f)throw new sn(`Expected section ${f}`);s++},l=()=>{s<i.length&&i[s].length>0&&s++;let f=[];for(;s<i.length&&i[s].length>0&&!o.has(i[s]);)f.push(i[s++]);for(;s<i.length&&i[s].length===0;)s++;return f},c={sectionProperties:[],materials:[],rectangles:[],polygons:[],supports:[],loadCases:[],meshingConfiguration:{maxMeshArea:NaN,refinementPoints:[]},solverConfiguration:{solverType:"lusolve"},resultPoints:[]};if(r()==="SOLVER_CONFIGURATION"){if(a("SOLVER_CONFIGURATION"),s<i.length&&i[s].length>0&&s++,s<i.length&&i[s].length>0){let f=n.parseCsvRow(i[s++]);c.solverConfiguration={solverType:f[0]??"lusolve"}}for(;s<i.length&&i[s].length===0;)s++}if(r()==="MESHING_CONFIGURATION"){if(a("MESHING_CONFIGURATION"),s<i.length&&i[s].length>0&&s++,s<i.length&&i[s].length>0){let f=n.parseCsvRow(i[s++]);c.meshingConfiguration.maxMeshArea=parseFloat(f[0]??"0")}for(;s<i.length&&i[s].length===0;)s++}if(r()==="REFINEMENT_POINTS"){a("REFINEMENT_POINTS"),s<i.length&&i[s].length>0&&s++;let f=[];for(;s<i.length&&i[s].length>0&&!o.has(i[s]);){let d=n.parseCsvRow(i[s++]),u=parseFloat(d[0]??"0"),y=parseFloat(d[1]??"0"),x=parseFloat(d[2]??"0"),h=parseFloat(d[3]??"0");f.push({x:u,y,radius:x,maxArea:h})}for(c.meshingConfiguration.refinementPoints=f;s<i.length&&i[s].length===0;)s++}if(r()==="RESULT_POINTS"){for(a("RESULT_POINTS"),s<i.length&&i[s].length>0&&s++;s<i.length&&i[s].length>0&&!o.has(i[s]);){let f=n.parseCsvRow(i[s++]),d=f[0]??"",u=parseFloat(f[1]??"0"),y=parseFloat(f[2]??"0");c.resultPoints.push({name:d,x:u,y})}for(;s<i.length&&i[s].length===0;)s++}if(r()==="MATERIALS"){a("MATERIALS");let f=l();for(let d of f){let u=n.parseCsvRow(d),y=u[0]??"",x=parseFloat(u[1]??"0"),h=parseFloat(u[2]??"0"),_=parseFloat(u[3]??"0");c.materials.push({name:y,modulusOfElasticity:x,poissonsRatio:h,weight:_})}}if(r()==="SECTION_PROPERTIES"){a("SECTION_PROPERTIES");let f=l();for(let d of f){let u=n.parseCsvRow(d),y=u[0]??"",x=parseFloat(u[1]??"0");c.sectionProperties.push({name:y,thickness:x})}}if(r()==="RECTANGLE_GEOMETRY"){a("RECTANGLE_GEOMETRY");let f=l();for(let d of f){let u=n.parseCsvRow(d),y=u[0]??"",x=parseFloat(u[1]??"0"),h=parseFloat(u[2]??"0"),_=parseFloat(u[3]??"0"),E=parseFloat(u[4]??"0"),N=u[5]??"",D=u[6]??"";c.rectangles.push({name:y,x,y:h,width:_,height:E,sectionName:N,materialName:D})}}if(r()==="POLYGONS"){a("POLYGONS");let f=l();for(let d of f){let u=n.parseCsvRow(d),y=u[0]??"",x=u[1]??"",h=u[2]??"",_=u[3]??"";c.polygons.push({name:y,points:x,sectionName:h,materialName:_})}}if(r()==="SUPPORTS"){a("SUPPORTS");let f=l();for(let d of f){let u=n.parseCsvRow(d),y=parseFloat(u[0]??"0"),x=parseFloat(u[1]??"0"),h=(u[2]??"false").toLowerCase()==="true",_=(u[3]??"false").toLowerCase()==="true";c.supports.push({x:y,y:x,fixedX:h,fixedY:_})}}if(r()==="LOAD_CASES"){a("LOAD_CASES");let f=l(),d=new Map;for(let u of f){let y=n.parseCsvRow(u),x=y[0]??"",h=(y[1]??"").toLowerCase();d.has(x)||d.set(x,{name:x,pointLoads:[],distributedLoads:[],includeDeadLoad:!1});let _=d.get(x);if(h==="point"){let E=parseFloat(y[3]??"0"),N=parseFloat(y[4]??"0"),D=parseFloat(y[5]??"0"),R=parseFloat(y[6]??"0");_.pointLoads.push({x:E,y:N,fx:D,fy:R})}else if(h==="distributed"){let E=y[2]??"",N=parseFloat(y[5]??"0"),D=parseFloat(y[6]??"0");_.distributedLoads.push({geometryName:E,fx:N,fy:D})}}c.loadCases=Array.from(d.values())}return{sectionProperties:c.sectionProperties??[],materials:c.materials??[],rectangles:c.rectangles??[],polygons:c.polygons??[],supports:c.supports??[],loadCases:c.loadCases??[],meshingConfiguration:c.meshingConfiguration??{maxMeshArea:NaN,refinementPoints:[]},solverConfiguration:c.solverConfiguration??{solverType:"lusolve"},resultPoints:c.resultPoints??[]}}};function Qu(n,e){if(n&1){let t=ee();p(0,"div",1)(1,"p-checkbox",4),I("ngModelChange",function(o){w(t);let s=v();return O(s.encode,o)||(s.encode=o),C(o)}),M("onChange",function(){w(t);let o=v();return C(o.changeSerializationType())}),m(),p(2,"label",5),S(3," Encode "),m()()}if(n&2){let t=v();b(),P("ngModel",t.encode),T("binary",!0)}}var co=class n extends st{membraneMessageService=Y(Ct);membraneService=Y(di);detector=Y(qe);serializationTypes=["yaml","json","csv","url"];selectedSerializationType="yaml";geometry;encode=!1;ngOnInit(){this.membraneMessageService.geometryChanged.pipe($e(this.destroyed$)).subscribe(e=>{this.geometry=e,this.changeSerializationType()})}value="";rows=10;changeSerializationType(){this.value=this.serializeGeometry(this.geometry),this.rows=this.value.split(`
`).length,this.detector.detectChanges()}parse(){let e=this.parseGeometry();this.membraneService.updateGeometry(e)}copy(){let e=this.value;this.selectedSerializationType==="url"&&(e=window.location.origin+window.location.pathname+window.location.hash+"?"+this.value.split(`
`).join("")),navigator.clipboard.writeText(e)}parseGeometry(){try{switch(this.selectedSerializationType){case"yaml":return is(this.value);case"json":return JSON.parse(this.value);case"url":return this.encode?ut.parse(this.value):ut.parseRaw(this.value);case"csv":return en.parseGeometryFromCsv(this.value);default:throw new Error("Unsupported serialization type")}}catch(e){throw this.membraneMessageService.showErrorMessage("Failed to parse geometry: "+e.message),new sn("Failed to parse geometry: "+e.message)}}serializeGeometry(e){switch(this.selectedSerializationType){case"yaml":return ns(e);case"json":return JSON.stringify(e,null,2);case"url":return this.encode?ut.stringify(e):ut.stringifyRaw(e);case"csv":return en.geometryToCsv(e);default:throw new Error("Unsupported serialization type")}}static \u0275fac=(()=>{let e;return function(i){return(e||(e=bt(n)))(i||n)}})();static \u0275cmp=ne({type:n,selectors:[["app-raw-geometry"]],features:[wt],decls:5,vars:7,consts:[["placeholder","Select serialization",1,"w-full","md:w-56",3,"ngModelChange","options","ngModel"],[1,"flex","items-center"],["icon","pi pi-copy","label","Copy",1,"ml-2",3,"onClick","disabled"],["pTextarea","","id","description",2,"resize","vertical","width","100%","height","100%",3,"ngModelChange","ngModel","rows","spellcheck"],["inputId","encode",3,"ngModelChange","onChange","ngModel","binary"],["for","encode",1,"ml-2"]],template:function(t,i){t&1&&(p(0,"p-select",0),I("ngModelChange",function(s){return O(i.selectedSerializationType,s)||(i.selectedSerializationType=s),s}),M("ngModelChange",function(){return i.changeSerializationType()}),m(),Ue(1,Qu,4,2,"div",1),p(2,"p-button",2),M("onClick",function(){return i.copy()}),m(),F(3,"p-divider"),p(4,"textarea",3),I("ngModelChange",function(s){return O(i.value,s)||(i.value=s),s}),M("ngModelChange",function(){return i.parse()}),m()),t&2&&(T("options",i.serializationTypes),P("ngModel",i.selectedSerializationType),b(),si(i.selectedSerializationType==="url"?1:-1),b(),T("disabled",!i.value),b(2),P("ngModel",i.value),T("rows",i.rows)("spellcheck",!1))},dependencies:[se,re,le,he,ae,pe,cn,ge,oe,an,nt,ot,ye,ue,_e,be,de,hi,me,St,we,Ce,Se,Me,ve,xe,Xs,fe,Te,Ee,Ne,ke,ce,Pe,Oe,gn],encapsulation:2,changeDetection:0})};function Zu(n,e){n&1&&(p(0,"div",4),F(1,"p-tag",5),m())}function ed(n,e){if(n&1&&(p(0,"div",3),F(1,"p-badge",6),p(2,"p",7),S(3),m()()),n&2){let t=e.$implicit;b(),T("value","!")("badgeSize","small"),b(2),nn(" ",t," ")}}function td(n,e){if(n&1&&(p(0,"p-fieldset"),Ue(1,Zu,2,0,"ng-template",null,0,ui),De(3,ed,4,3,"div",3,Ae),m()),n&2){let t=v();b(3),Fe(t.errors)}}var mo=class n extends st{membraneService=Y(di);membraneMessageService=Y(Ct);changeDetector=Y(qe);progress="";subProgress="";iterationProgress="";errors=[];solve(){return W(this,null,function*(){this.errors=[],yield this.membraneService.solve()})}ngOnInit(){return W(this,null,function*(){this.membraneMessageService.progressChanged.pipe($e(this.destroyed$),z(e=>{e.message&&(this.progress=e.message)}),z(e=>{e.subMessage&&(this.subProgress=e.subMessage)}),z(e=>{e.iterationMessage&&(this.iterationProgress=e.iterationMessage)})).subscribe(()=>this.changeDetector.detectChanges()),this.membraneMessageService.errorMessageChanged.pipe($e(this.destroyed$),z(e=>this.errors=[...e])).subscribe(()=>this.changeDetector.detectChanges())})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=bt(n)))(i||n)}})();static \u0275cmp=ne({type:n,selectors:[["app-control-panel"]],features:[wt],decls:10,vars:4,consts:[["header",""],[1,"mt-2"],["label","Solve",3,"onClick"],[1,"flex","items-center"],[1,"flex","items-center","gap-2","px-2"],["severity","danger","value","Errors"],["severity","danger",3,"value","badgeSize"],[1,"pl-1"]],template:function(t,i){t&1&&(p(0,"div",1)(1,"p-button",2),M("onClick",function(){return i.solve()}),m(),p(2,"p"),S(3),m(),p(4,"p"),S(5),m(),p(6,"p"),S(7),m()(),F(8,"p-divider"),Ue(9,td,5,0,"p-fieldset")),t&2&&(b(3),X(i.progress),b(2),X(i.subProgress),b(2),X(i.iterationProgress),b(2),si(i.errors.length>0?9:-1))},dependencies:[se,re,le,he,ae,pe,ge,oe,ye,ue,_e,be,de,me,St,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,Qs,ke,Zs,ce,Us,Pe,Oe,gn],styles:[".error-container[_ngcontent-%COMP%]{background-color:var(--p-red-400)}"],changeDetection:0})};var Xl=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ne({type:n,selectors:[["app-membrane"]],decls:21,vars:2,consts:[[1,"grid","grid-cols-2","gap-2","ml-2"],["value","0"],["value","1"],["value","2"],[1,"sticky","top-0"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"div"),F(2,"app-control-panel"),p(3,"p-tabs",1)(4,"p-tablist")(5,"p-tab",1),S(6,"Geometry"),m(),p(7,"p-tab",2),S(8,"Raw Geometry"),m(),p(9,"p-tab",3),S(10,"Results"),m()(),p(11,"p-tabpanels")(12,"p-tabpanel",1),F(13,"app-geometry"),m(),p(14,"p-tabpanel",2),F(15,"app-raw-geometry"),m(),p(16,"p-tabpanel",3),F(17,"app-results"),m()()()(),p(18,"div")(19,"div",4),F(20,"app-view3d"),m()()()),t&2&&(b(3),gs("flex-grow:1"))},dependencies:[En,Cn,mo,Sn,se,Ks,Ws,qs,js,$s,re,le,he,ae,pe,ge,oe,ye,ue,_e,be,de,me,we,Ce,Se,Me,ve,xe,fe,Te,Ee,Ne,ke,ce,Pe,Oe,co],styles:["[_nghost-%COMP%]     p-panel div.p-panel{margin-bottom:calc(var(--spacing) * 4)}"],changeDetection:0})};export{Xl as MembraneComponent};
